!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("engine",[],t):"object"==typeof exports?exports.engine=t():e.engine=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=32)}([function(e,t,n){"use strict";n(2),n(33),n(34),n(20);var i=n(35),r=n(36),o=(n(37),n(21)),a=n(22);n.d(t,"a",function(){return i}),n.d(t,"b",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return a})},function(e,t,n){"use strict";n(19);var i=n(0),r=n(41);let o;class a{constructor(e){this._initialize(),this.initializedMaterialUBO=!1}_initialize(){o=canvas.getContext("webgl2",{antialias:!1}),this.materialUBO=new r.a(new Float32Array(a.MATERIAL_DATA_CHUNK_SIZE)),this.modelMatricesUBO=new r.a([...i.a.create(),...i.a.create()]),this.sceneMatricesUBO=new r.a([...i.a.create(),...i.a.create()]),this.directionalUBO=new r.a(new Float32Array(a.MAX_LIGHTS*a.LIGHT_DATA_CHUNK_SIZE))}_renderObject(e,t,n){this.modelMatricesUBO.update([...e.modelMatrix,...e.normalMatrix]);for(let n=0;n<e.shaders.length;++n){const i=e.shaders[n],r=i.program,o=i.programInfo,a=i.materialData,u=t.gui.displayBump,c=t.gui.bumpIntensity;this.materialUBO.update([...[...a.ambient,0],...[...a.diffuse,0],...[...a.specular,0],a.specularExponent,c,Boolean(a.mapDiffuse),Boolean(a.mapBump),Boolean(a.mapSpecular),u,t.gui.displaySpecular]),i.activate();const l=s();l.uniform1i(o.uniformLocations.numLights,t.lights.length),i.bindTextures(),l.uniformBlockBinding(r,o.uniformBlockLocations.material,this.materialUBO.location),l.uniformBlockBinding(r,o.uniformBlockLocations.scene,this.sceneMatricesUBO.location),l.uniformBlockBinding(r,o.uniformBlockLocations.model,this.modelMatricesUBO.location),l.uniformBlockBinding(r,o.uniformBlockLocations.directional,this.directionalUBO.location),e.draw(n)}}_internalRender(e,t){this.sceneMatricesUBO.bind(),this.directionalUBO.bind(),this.modelMatricesUBO.bind(),this.materialUBO.bind(),this.sceneMatricesUBO.update([...t.viewMatrix,...t.projectionMatrix]);for(let t=0;t<e.lights.length;t++){const n=e.lights[t];this.directionalUBO.update([...[n.positionViewSpace[0],n.positionViewSpace[1],n.positionViewSpace[2]],...n.color,...[n.intensity,0,0,0]],t*a.LIGHT_DATA_CHUNK_SIZE)}e.objects.forEach(n=>{this._renderObject(n,e,t)}),e.lights.forEach(e=>{if(e._debug){const n=i.a.create();i.a.multiply(n,t.viewMatrix,e.modelMatrix),i.a.multiply(n,t.projectionMatrix,n),e.draw(n)}})}setSize(e,t){const n=e*window.devicePixelRatio,i=t*window.devicePixelRatio,r=s();r.canvas.width=n,r.canvas.height=i,r.canvas.style.width=`${n/window.devicePixelRatio}px`,r.canvas.style.height=`${i/window.devicePixelRatio}px`}render(e,t){const n=s();n.viewport(0,0,n.canvas.width,n.canvas.height),n.clearColor(0,0,0,1),n.clearDepth(1),n.cullFace(n.BACK),n.enable(n.CULL_FACE),n.enable(n.DEPTH_TEST),n.depthFunc(n.LEQUAL),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),this._internalRender(e,t)}}a.LIGHT_DATA_CHUNK_SIZE=12,a.MATERIAL_DATA_CHUNK_SIZE=50,a.MAX_LIGHTS=16,a.MAX_MATERIALS=25;const s=()=>o;t.b=s,t.a=a},function(e,t,n){"use strict";n.d(t,"a",function(){return r});const i=1e-6;t.b=i;let r="undefined"!=typeof Float32Array?Float32Array:Array;const o=Math.random;t.c=o;Math.PI},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function i(e){if(!(this instanceof i))return new i(e);c.call(this,e),l.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",r)}function r(){this.allowHalfOpen||this._writableState.ended||a(o,this)}function o(e){e.end()}var a=n(10),s=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=i;var u=n(8);u.inherits=n(6);var c=n(26),l=n(17);u.inherits(i,c);for(var h=s(l.prototype),f=0;f<h.length;f++){var d=h[f];i.prototype[d]||(i.prototype[d]=l.prototype[d])}Object.defineProperty(i.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),i.prototype._destroy=function(e,t){this.push(null),this.end(),a(t,e)}},function(e,t,n){"use strict";function i(e,t,n){const i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)?i:(alert("An error occurred compiling the shaders: "+e.getShaderInfoLog(i)),e.deleteShader(i),null)}t.a=((e,t,n)=>{const r=i(e,e.VERTEX_SHADER,t),o=i(e,e.FRAGMENT_SHADER,n),a=e.createProgram();if(e.attachShader(a,r),e.attachShader(a,o),e.linkProgram(a),e.getProgramParameter(a,e.LINK_STATUS))return a;alert("Unable to initialize the shader program: "+e.getProgramInfoLog(a))})},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function r(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function o(e){if(h===clearTimeout)return clearTimeout(e);if((h===i||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function a(){m&&d&&(m=!1,d.length?p=d.concat(p):v=-1,p.length&&s())}function s(){if(!m){var e=r(a);m=!0;for(var t=p.length;t;){for(d=p,p=[];++v<t;)d&&d[v].run();v=-1,t=p.length}d=null,m=!1,o(e)}}function u(e,t){this.fun=e,this.array=t}function c(){}var l,h,f=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{h="function"==typeof clearTimeout?clearTimeout:i}catch(e){h=i}}();var d,p=[],m=!1,v=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new u(e,t)),1!==p.length||m||r(s)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.prependListener=c,f.prependOnceListener=c,f.listeners=function(e){return[]},f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(e,t,n){(function(e){function n(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===n(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===n(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===n(e)},t.isError=function(e){return"[object Error]"===n(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=e.isBuffer}).call(t,n(16).Buffer)},function(e,t,n){"use strict";var i=n(1);class r{constructor(){const e=Object(i.b)();this._textureId=e.createTexture()}createTexture(e){const t=Object(i.b)();this._level=0,this._internalFormat=t.RGBA4,this._width=e.width,this._height=e.height,this._border=0,this._format=t.RGBA,this._dataType=t.UNSIGNED_BYTE,this._data=e,this.bind(),t.texImage2D(t.TEXTURE_2D,this._level,this._internalFormat,this._width,this._height,this._border,this._format,this._dataType,this._data),this._width&&this._height||console.err("Missing width or height"),r.isPowerOf2(this._width)&&r.isPowerOf2(this._height)?t.generateMipmap(t.TEXTURE_2D):(console.warn("Non-power of 2 texture"),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR))}bind(){const e=Object(i.b)();e.bindTexture(e.TEXTURE_2D,this._textureId)}static isPowerOf2(e){return 0==(e&e-1)}}t.a=r},function(e,t,n){"use strict";(function(t){!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports=function(e,n,i,r){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var o,a,s=arguments.length;switch(s){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick(function(){e.call(null,n)});case 3:return t.nextTick(function(){e.call(null,n,i)});case 4:return t.nextTick(function(){e.call(null,n,i,r)});default:for(o=new Array(s-1),a=0;a<o.length;)o[a++]=arguments[a];return t.nextTick(function(){e.apply(null,o)})}}:e.exports=t.nextTick}).call(t,n(7))},function(e,t,n){"use strict";var i=n(0);class r{constructor(){this.quaternionAxisAngle=i.c.create(),this.position=i.c.create(),this.rotation=i.c.create(),this.scale=i.c.fromValues(1,1,1),this.quaternion=i.b.create(),this.modelMatrix=i.a.create()}update(){i.a.identity(this.modelMatrix),i.b.identity(this.quaternion),i.b.rotateX(this.quaternion,this.quaternion,this.rotation[0]),i.b.rotateY(this.quaternion,this.quaternion,this.rotation[1]),i.b.rotateZ(this.quaternion,this.quaternion,this.rotation[2]);const e=i.b.getAxisAngle(this.quaternionAxisAngle,this.quaternion);i.a.translate(this.modelMatrix,this.modelMatrix,this.position),i.a.rotate(this.modelMatrix,this.modelMatrix,e,this.quaternionAxisAngle),i.a.scale(this.modelMatrix,this.modelMatrix,this.scale)}}t.a=r},function(e,t,n){"use strict";function i(e){let t=[];for(let n=0;n<e.length;++n)Array.isArray(e[n])||e[n]instanceof Float32Array?t=t.concat(i(e[n])):t.push(e[n]);return t}function r(e,t){const n=[];for(let i=0;i<e.length;i+=t){const r=[];for(let n=0;n<t;n++)r.push(e[i+n]);n.push(r)}return n}function o(e,t){const n=r(t,3),o=r(e,3),s=[],u=a.c.create(),c=a.c.create(),l=a.c.create();let h,f,d;for(let e=0;e<n.length;e++){const t=n[e],i=t[0],r=t[1],p=t[2];h=o[i],f=o[r],d=o[p],a.c.subtract(u,d,f),a.c.subtract(c,h,f),a.c.cross(l,u,c),void 0===s[i]&&(s[i]=a.c.create()),void 0===s[r]&&(s[r]=a.c.create()),void 0===s[p]&&(s[p]=a.c.create()),a.c.add(s[i],s[i],l),a.c.add(s[r],s[r],l),a.c.add(s[p],s[p],l)}for(let e=0;e<s.length;e++)a.c.normalize(s[e],s[e]);return i(s,3)}t.a=i,t.d=r,t.c=function(e){const t=[];for(let n=0;n<e.length;++n)t[n]=.5;return t},t.b=o;var a=n(0)},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function r(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!r(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,r,s,u,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(n=this._events[e],a(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(o(n))for(s=Array.prototype.slice.call(arguments,1),r=(c=n.slice()).length,u=0;u<r;u++)c[u].apply(this,s);return!0},n.prototype.addListener=function(e,t){var r;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(r=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!i(t))throw TypeError("listener must be a function");var r=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,r,a,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],a=n.length,r=-1,n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(s=a;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){r=s;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],i(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,n){(t=e.exports=n(26)).Stream=t,t.Readable=t,t.Writable=n(17),t.Duplex=n(4),t.Transform=n(30),t.PassThrough=n(63)},function(e,t,n){function i(e,t){for(var n in e)t[n]=e[n]}function r(e,t,n){return a(e,t,n)}var o=n(16),a=o.Buffer;a.from&&a.alloc&&a.allocUnsafe&&a.allocUnsafeSlow?e.exports=o:(i(o,t),t.Buffer=r),i(a,r),r.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return a(e,t,n)},r.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=a(e);return void 0!==t?"string"==typeof n?i.fill(t,n):i.fill(t):i.fill(0),i},r.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return a(e)},r.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return o.SlowBuffer(e)}},function(e,t,n){"use strict";(function(e){function i(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function r(e,t){if(i()<t)throw new RangeError("Invalid typed array length");return o.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=o.prototype:(null===e&&(e=new o(t)),e.length=t),e}function o(e,t,n){if(!(o.TYPED_ARRAY_SUPPORT||this instanceof o))return new o(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}return a(this,e,t,n)}function a(e,t,n,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?f(e,t,n,i):"string"==typeof t?l(e,t,n):d(e,t)}function s(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t,n,i){return s(t),t<=0?r(e,t):void 0!==n?"string"==typeof i?r(e,t).fill(n,i):r(e,t).fill(n):r(e,t)}function c(e,t){if(s(t),e=r(e,t<0?0:0|p(t)),!o.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function l(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!o.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|m(t,n),a=(e=r(e,i)).write(t,n);return a!==i&&(e=e.slice(0,a)),e}function h(e,t){var n=t.length<0?0:0|p(t.length);e=r(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function f(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i),o.TYPED_ARRAY_SUPPORT?(e=t).__proto__=o.prototype:e=h(e,t),e}function d(e,t){if(o.isBuffer(t)){var n=0|p(t.length);return 0===(e=r(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||W(t.length)?r(e,0):h(e,t);if("Buffer"===t.type&&Q(t.data))return h(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function p(e){if(e>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|e}function m(e,t){if(o.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return X(e).length;default:if(i)return H(e).length;t=(""+t).toLowerCase(),i=!0}}function v(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return C(this,t,n);case"utf8":case"utf-8":return L(this,t,n);case"ascii":return R(this,t,n);case"latin1":case"binary":return k(this,t,n);case"base64":return A(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function g(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function b(e,t,n,i,r){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=o.from(t,i)),o.isBuffer(t))return 0===t.length?-1:_(e,t,n,i,r);if("number"==typeof t)return t&=255,o.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):_(e,[t],n,i,r);throw new TypeError("val must be string, number or Buffer")}function _(e,t,n,i,r){function o(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}var a=1,s=e.length,u=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,n/=2}var c;if(r){var l=-1;for(c=n;c<s;c++)if(o(e,c)===o(t,-1===l?0:c-l)){if(-1===l&&(l=c),c-l+1===u)return l*a}else-1!==l&&(c-=c-l),l=-1}else for(n+u>s&&(n=s-u),c=n;c>=0;c--){for(var h=!0,f=0;f<u;f++)if(o(e,c+f)!==o(t,f)){h=!1;break}if(h)return c}return-1}function y(e,t,n,i){n=Number(n)||0;var r=e.length-n;i?(i=Number(i))>r&&(i=r):i=r;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");i>o/2&&(i=o/2);for(var a=0;a<i;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function w(e,t,n,i){return G(H(t,e.length-n),e,n,i)}function M(e,t,n,i){return G(q(t),e,n,i)}function x(e,t,n,i){return M(e,t,n,i)}function S(e,t,n,i){return G(X(t),e,n,i)}function E(e,t,n,i){return G(Y(t,e.length-n),e,n,i)}function A(e,t,n){return 0===t&&n===e.length?K.fromByteArray(e):K.fromByteArray(e.slice(t,n))}function L(e,t,n){n=Math.min(e.length,n);for(var i=[],r=t;r<n;){var o=e[r],a=null,s=o>239?4:o>223?3:o>191?2:1;if(r+s<=n){var u,c,l,h;switch(s){case 1:o<128&&(a=o);break;case 2:128==(192&(u=e[r+1]))&&(h=(31&o)<<6|63&u)>127&&(a=h);break;case 3:u=e[r+1],c=e[r+2],128==(192&u)&&128==(192&c)&&(h=(15&o)<<12|(63&u)<<6|63&c)>2047&&(h<55296||h>57343)&&(a=h);break;case 4:u=e[r+1],c=e[r+2],l=e[r+3],128==(192&u)&&128==(192&c)&&128==(192&l)&&(h=(15&o)<<18|(63&u)<<12|(63&c)<<6|63&l)>65535&&h<1114112&&(a=h)}}null===a?(a=65533,s=1):a>65535&&(a-=65536,i.push(a>>>10&1023|55296),a=56320|1023&a),i.push(a),r+=s}return T(i)}function T(e){var t=e.length;if(t<=Z)return String.fromCharCode.apply(String,e);for(var n="",i=0;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=Z));return n}function R(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(127&e[r]);return i}function k(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(e[r]);return i}function C(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var r="",o=t;o<n;++o)r+=z(e[o]);return r}function I(e,t,n){for(var i=e.slice(t,n),r="",o=0;o<i.length;o+=2)r+=String.fromCharCode(i[o]+256*i[o+1]);return r}function O(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function B(e,t,n,i,r,a){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<a)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function P(e,t,n,i){t<0&&(t=65535+t+1);for(var r=0,o=Math.min(e.length-n,2);r<o;++r)e[n+r]=(t&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function N(e,t,n,i){t<0&&(t=4294967295+t+1);for(var r=0,o=Math.min(e.length-n,4);r<o;++r)e[n+r]=t>>>8*(i?r:3-r)&255}function D(e,t,n,i,r,o){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function U(e,t,n,i,r){return r||D(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),J.write(e,t,n,i,23,4),n+4}function F(e,t,n,i,r){return r||D(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),J.write(e,t,n,i,52,8),n+8}function j(e){if((e=V(e).replace($,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function V(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function z(e){return e<16?"0"+e.toString(16):e.toString(16)}function H(e,t){t=t||1/0;for(var n,i=e.length,r=null,o=[],a=0;a<i;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===i){(t-=3)>-1&&o.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&o.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function q(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function Y(e,t){for(var n,i,r,o=[],a=0;a<e.length&&!((t-=2)<0);++a)i=(n=e.charCodeAt(a))>>8,r=n%256,o.push(r),o.push(i);return o}function X(e){return K.toByteArray(j(e))}function G(e,t,n,i){for(var r=0;r<i&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}function W(e){return e!==e}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var K=n(56),J=n(57),Q=n(27);t.Buffer=o,t.SlowBuffer=function(e){return+e!=e&&(e=0),o.alloc(+e)},t.INSPECT_MAX_BYTES=50,o.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=i(),o.poolSize=8192,o._augment=function(e){return e.__proto__=o.prototype,e},o.from=function(e,t,n){return a(null,e,t,n)},o.TYPED_ARRAY_SUPPORT&&(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0})),o.alloc=function(e,t,n){return u(null,e,t,n)},o.allocUnsafe=function(e){return c(null,e)},o.allocUnsafeSlow=function(e){return c(null,e)},o.isBuffer=function(e){return!(null==e||!e._isBuffer)},o.compare=function(e,t){if(!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,r=0,a=Math.min(n,i);r<a;++r)if(e[r]!==t[r]){n=e[r],i=t[r];break}return n<i?-1:i<n?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Q(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=o.allocUnsafe(t),r=0;for(n=0;n<e.length;++n){var a=e[n];if(!o.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,r),r+=a.length}return i},o.byteLength=m,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},o.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?L(this,0,e):v.apply(this,arguments)},o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},o.prototype.compare=function(e,t,n,i,r){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),t<0||n>e.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&t>=n)return 0;if(i>=r)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,i>>>=0,r>>>=0,this===e)return 0;for(var a=r-i,s=n-t,u=Math.min(a,s),c=this.slice(i,r),l=e.slice(t,n),h=0;h<u;++h)if(c[h]!==l[h]){a=c[h],s=l[h];break}return a<s?-1:s<a?1:0},o.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},o.prototype.indexOf=function(e,t,n){return b(this,e,t,n,!0)},o.prototype.lastIndexOf=function(e,t,n){return b(this,e,t,n,!1)},o.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var o=!1;;)switch(i){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":return M(this,e,t,n);case"latin1":case"binary":return x(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Z=4096;o.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var i;if(o.TYPED_ARRAY_SUPPORT)(i=this.subarray(e,t)).__proto__=o.prototype;else{var r=t-e;i=new o(r,void 0);for(var a=0;a<r;++a)i[a]=this[a+e]}return i},o.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var i=this[e],r=1,o=0;++o<t&&(r*=256);)i+=this[e+o]*r;return i},o.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var i=this[e+--t],r=1;t>0&&(r*=256);)i+=this[e+--t]*r;return i},o.prototype.readUInt8=function(e,t){return t||O(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return t||O(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return t||O(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var i=this[e],r=1,o=0;++o<t&&(r*=256);)i+=this[e+o]*r;return r*=128,i>=r&&(i-=Math.pow(2,8*t)),i},o.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var i=t,r=1,o=this[e+--i];i>0&&(r*=256);)o+=this[e+--i]*r;return r*=128,o>=r&&(o-=Math.pow(2,8*t)),o},o.prototype.readInt8=function(e,t){return t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){t||O(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt16BE=function(e,t){t||O(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt32LE=function(e,t){return t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return t||O(e,4,this.length),J.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return t||O(e,4,this.length),J.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return t||O(e,8,this.length),J.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return t||O(e,8,this.length),J.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,n,i){e=+e,t|=0,n|=0,i||B(this,e,t,n,Math.pow(2,8*n)-1,0);var r=1,o=0;for(this[t]=255&e;++o<n&&(r*=256);)this[t+o]=e/r&255;return t+n},o.prototype.writeUIntBE=function(e,t,n,i){e=+e,t|=0,n|=0,i||B(this,e,t,n,Math.pow(2,8*n)-1,0);var r=n-1,o=1;for(this[t+r]=255&e;--r>=0&&(o*=256);)this[t+r]=e/o&255;return t+n},o.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,1,255,0),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):P(this,e,t,!0),t+2},o.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):P(this,e,t,!1),t+2},o.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):N(this,e,t,!0),t+4},o.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},o.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);B(this,e,t,n,r-1,-r)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},o.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);B(this,e,t,n,r-1,-r)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},o.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,1,127,-128),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):P(this,e,t,!0),t+2},o.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):P(this,e,t,!1),t+2},o.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):N(this,e,t,!0),t+4},o.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},o.prototype.writeFloatLE=function(e,t,n){return U(this,e,t,!0,n)},o.prototype.writeFloatBE=function(e,t,n){return U(this,e,t,!1,n)},o.prototype.writeDoubleLE=function(e,t,n){return F(this,e,t,!0,n)},o.prototype.writeDoubleBE=function(e,t,n){return F(this,e,t,!1,n)},o.prototype.copy=function(e,t,n,i){if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var r,a=i-n;if(this===e&&n<t&&t<i)for(r=a-1;r>=0;--r)e[r+t]=this[r+n];else if(a<1e3||!o.TYPED_ARRAY_SUPPORT)for(r=0;r<a;++r)e[r+t]=this[r+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},o.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var r=e.charCodeAt(0);r<256&&(e=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!o.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0);var a;if("number"==typeof e)for(a=t;a<n;++a)this[a]=e;else{var s=o.isBuffer(e)?e:H(new o(e,i).toString()),u=s.length;for(a=0;a<n-t;++a)this[a+t]=s[a%u]}return this};var $=/[^+\/0-9A-Za-z-_]/g}).call(t,n(3))},function(e,t,n){"use strict";(function(t,i,r){function o(e){var t=this;this.next=null,this.entry=null,this.finish=function(){L(t,e)}}function a(e){return B.from(e)}function s(e){return B.isBuffer(e)||e instanceof P}function u(){}function c(e,t){R=R||n(4),e=e||{},this.objectMode=!!e.objectMode,t instanceof R&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var i=e.highWaterMark,r=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===e.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){b(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function l(e){if(R=R||n(4),!(D.call(l,this)||this instanceof R))return new l(e);this._writableState=new c(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),O.call(this)}function h(e,t){var n=new Error("write after end");e.emit("error",n),T(t,n)}function f(e,t,n,i){var r=!0,o=!1;return null===n?o=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),T(i,o),r=!1),r}function d(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=B.from(t,n)),t}function p(e,t,n,i,r,o){if(!n){var a=d(t,i,r);i!==a&&(n=!0,r="buffer",i=a)}var s=t.objectMode?1:i.length;t.length+=s;var u=t.length<t.highWaterMark;if(u||(t.needDrain=!0),t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:r,isBuf:n,callback:o,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else m(e,t,!1,s,i,r,o);return u}function m(e,t,n,i,r,o,a){t.writelen=i,t.writecb=a,t.writing=!0,t.sync=!0,n?e._writev(r,t.onwrite):e._write(r,o,t.onwrite),t.sync=!1}function v(e,t,n,i,r){--t.pendingcb,n?(T(r,i),T(E,e,t),e._writableState.errorEmitted=!0,e.emit("error",i)):(r(i),e._writableState.errorEmitted=!0,e.emit("error",i),E(e,t))}function g(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function b(e,t){var n=e._writableState,i=n.sync,r=n.writecb;if(g(n),t)v(e,n,i,t,r);else{var o=M(n);o||n.corked||n.bufferProcessing||!n.bufferedRequest||w(e,n),i?k(_,e,n,o,r):_(e,n,o,r)}}function _(e,t,n,i){n||y(e,t),t.pendingcb--,i(),E(e,t)}function y(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function w(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var i=t.bufferedRequestCount,r=new Array(i),a=t.corkedRequestsFree;a.entry=n;for(var s=0,u=!0;n;)r[s]=n,n.isBuf||(u=!1),n=n.next,s+=1;r.allBuffers=u,m(e,t,!0,t.length,r,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new o(t)}else{for(;n;){var c=n.chunk,l=n.encoding,h=n.callback;if(m(e,t,!1,t.objectMode?1:c.length,c,l,h),n=n.next,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=n,t.bufferProcessing=!1}function M(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function x(e,t){e._final(function(n){t.pendingcb--,n&&e.emit("error",n),t.prefinished=!0,e.emit("prefinish"),E(e,t)})}function S(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,T(x,e,t)):(t.prefinished=!0,e.emit("prefinish")))}function E(e,t){var n=M(t);return n&&(S(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}function A(e,t,n){t.ending=!0,E(e,t),n&&(t.finished?T(n):e.once("finish",n)),t.ended=!0,e.writable=!1}function L(e,t,n){var i=e.entry;for(e.entry=null;i;){var r=i.callback;t.pendingcb--,r(n),i=i.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}var T=n(10);e.exports=l;var R,k=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?i:T;l.WritableState=c;var C=n(8);C.inherits=n(6);var I={deprecate:n(62)},O=n(28),B=n(15).Buffer,P=r.Uint8Array||function(){},N=n(29);C.inherits(l,O),c.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(c.prototype,"buffer",{get:I.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}();var D;"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(D=Function.prototype[Symbol.hasInstance],Object.defineProperty(l,Symbol.hasInstance,{value:function(e){return!!D.call(this,e)||e&&e._writableState instanceof c}})):D=function(e){return e instanceof this},l.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},l.prototype.write=function(e,t,n){var i=this._writableState,r=!1,o=s(e)&&!i.objectMode;return o&&!B.isBuffer(e)&&(e=a(e)),"function"==typeof t&&(n=t,t=null),o?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof n&&(n=u),i.ended?h(this,n):(o||f(this,i,e,n))&&(i.pendingcb++,r=p(this,i,o,e,t,n)),r},l.prototype.cork=function(){this._writableState.corked++},l.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||w(this,e))},l.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},l.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},l.prototype._writev=null,l.prototype.end=function(e,t,n){var i=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!==e&&void 0!==e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||A(this,i,n)},Object.defineProperty(l.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),l.prototype.destroy=N.destroy,l.prototype._undestroy=N.undestroy,l.prototype._destroy=function(e,t){this.end(),t(e)}}).call(t,n(7),n(60).setImmediate,n(3))},function(e,t,n){function i(e){if(e&&!u(e))throw new Error("Unknown encoding: "+e)}function r(e){return e.toString(this.encoding)}function o(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function a(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}var s=n(16).Buffer,u=s.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},c=t.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),i(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=o;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=a;break;default:return void(this.write=r)}this.charBuffer=new s(6),this.charReceived=0,this.charLength=0};c.prototype.write=function(e){for(var t="";this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";if(e=e.slice(n,e.length),!((r=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&r<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);i=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,i),i-=this.charReceived);var i=(t+=e.toString(this.encoding,0,i)).length-1,r=t.charCodeAt(i);if(r>=55296&&r<=56319){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),e.copy(this.charBuffer,0,0,o),t.substring(0,i)}return t},c.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var n=e[e.length-t];if(1==t&&n>>5==6){this.charLength=2;break}if(t<=2&&n>>4==14){this.charLength=3;break}if(t<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=t},c.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,i=this.charBuffer,r=this.encoding;t+=i.slice(0,n).toString(r)}return t}},function(e,t,n){"use strict";var i=n(0),r=n(38),o=n(23);class a{constructor(){this.objects=[],this.lights=[],this._gui=new r.a}get gui(){return this._gui}add(e){if(e instanceof o.a){const t=e;this.lights.push(t);const n=this._gui.lights.addFolder("Light "+this.lights.length);return n.add(t.position,"x",-1e3,1e3).name("Pos x"),n.add(t.position,"y",-1e3,1e3).name("Pos y"),void n.add(t.position,"z",-1e3,1e3).name("Pos z")}this.objects.push(e)}traverse(e){for(let t=0;t<this.objects.length;++t){this.objects[t].update();const n=this.objects[t].modelMatrix,r=i.a.create(),o=i.a.create();i.a.multiply(o,e.viewMatrix,n),i.a.invert(r,o),i.a.transpose(this.objects[t].normalMatrix,r)}for(let t=0;t<this.lights.length;t++){this.lights[t].update();const n=this.lights[t].position,r=i.d.fromValues(n[0],n[1],n[2],1);i.d.transformMat4(r,r,e.viewMatrix),this.lights[t].positionViewSpace[0]=r[0],this.lights[t].positionViewSpace[1]=r[1],this.lights[t].positionViewSpace[2]=r[2]}}}t.a=a},function(e,t,n){"use strict";t.a=function(){let e=new i.a(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e};var i=n(2)},function(e,t,n){"use strict";function i(){let e=new p.a(3);return e[0]=0,e[1]=0,e[2]=0,e}function r(e){let t=e[0],n=e[1],i=e[2];return Math.sqrt(t*t+n*n+i*i)}function o(e,t,n){let i=new p.a(3);return i[0]=e,i[1]=t,i[2]=n,i}function a(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function s(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}function u(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}function c(e,t){let n=t[0]-e[0],i=t[1]-e[1],r=t[2]-e[2];return Math.sqrt(n*n+i*i+r*r)}function l(e,t){let n=t[0]-e[0],i=t[1]-e[1],r=t[2]-e[2];return n*n+i*i+r*r}function h(e){let t=e[0],n=e[1],i=e[2];return t*t+n*n+i*i}function f(e,t){let n=t[0],i=t[1],r=t[2],o=n*n+i*i+r*r;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e}function d(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}Object.defineProperty(t,"__esModule",{value:!0}),t.create=i,t.clone=function(e){var t=new p.a(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},t.length=r,t.fromValues=o,t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.set=function(e,t,n,i){return e[0]=t,e[1]=n,e[2]=i,e},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e},t.subtract=a,t.multiply=s,t.divide=u,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},t.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e},t.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},t.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e},t.scaleAndAdd=function(e,t,n,i){return e[0]=t[0]+n[0]*i,e[1]=t[1]+n[1]*i,e[2]=t[2]+n[2]*i,e},t.distance=c,t.squaredDistance=l,t.squaredLength=h,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},t.normalize=f,t.dot=d,t.cross=function(e,t,n){let i=t[0],r=t[1],o=t[2],a=n[0],s=n[1],u=n[2];return e[0]=r*u-o*s,e[1]=o*a-i*u,e[2]=i*s-r*a,e},t.lerp=function(e,t,n,i){let r=t[0],o=t[1],a=t[2];return e[0]=r+i*(n[0]-r),e[1]=o+i*(n[1]-o),e[2]=a+i*(n[2]-a),e},t.hermite=function(e,t,n,i,r,o){let a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,c=a*(o-1),l=a*(3-2*o);return e[0]=t[0]*s+n[0]*u+i[0]*c+r[0]*l,e[1]=t[1]*s+n[1]*u+i[1]*c+r[1]*l,e[2]=t[2]*s+n[2]*u+i[2]*c+r[2]*l,e},t.bezier=function(e,t,n,i,r,o){let a=1-o,s=a*a,u=o*o,c=s*a,l=3*o*s,h=3*u*a,f=u*o;return e[0]=t[0]*c+n[0]*l+i[0]*h+r[0]*f,e[1]=t[1]*c+n[1]*l+i[1]*h+r[1]*f,e[2]=t[2]*c+n[2]*l+i[2]*h+r[2]*f,e},t.random=function(e,t){t=t||1;let n=2*p.c()*Math.PI,i=2*p.c()-1,r=Math.sqrt(1-i*i)*t;return e[0]=Math.cos(n)*r,e[1]=Math.sin(n)*r,e[2]=i*t,e},t.transformMat4=function(e,t,n){let i=t[0],r=t[1],o=t[2],a=n[3]*i+n[7]*r+n[11]*o+n[15];return a=a||1,e[0]=(n[0]*i+n[4]*r+n[8]*o+n[12])/a,e[1]=(n[1]*i+n[5]*r+n[9]*o+n[13])/a,e[2]=(n[2]*i+n[6]*r+n[10]*o+n[14])/a,e},t.transformMat3=function(e,t,n){let i=t[0],r=t[1],o=t[2];return e[0]=i*n[0]+r*n[3]+o*n[6],e[1]=i*n[1]+r*n[4]+o*n[7],e[2]=i*n[2]+r*n[5]+o*n[8],e},t.transformQuat=function(e,t,n){let i=t[0],r=t[1],o=t[2],a=n[0],s=n[1],u=n[2],c=n[3],l=c*i+s*o-u*r,h=c*r+u*i-a*o,f=c*o+a*r-s*i,d=-a*i-s*r-u*o;return e[0]=l*c+d*-a+h*-u-f*-s,e[1]=h*c+d*-s+f*-a-l*-u,e[2]=f*c+d*-u+l*-s-h*-a,e},t.rotateX=function(e,t,n,i){let r=[],o=[];return r[0]=t[0]-n[0],r[1]=t[1]-n[1],r[2]=t[2]-n[2],o[0]=r[0],o[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),o[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},t.rotateY=function(e,t,n,i){let r=[],o=[];return r[0]=t[0]-n[0],r[1]=t[1]-n[1],r[2]=t[2]-n[2],o[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),o[1]=r[1],o[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},t.rotateZ=function(e,t,n,i){let r=[],o=[];return r[0]=t[0]-n[0],r[1]=t[1]-n[1],r[2]=t[2]-n[2],o[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),o[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),o[2]=r[2],e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},t.angle=function(e,t){let n=o(e[0],e[1],e[2]),i=o(t[0],t[1],t[2]);f(n,n),f(i,i);let r=d(n,i);return r>1?0:r<-1?Math.PI:Math.acos(r)},t.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},t.equals=function(e,t){let n=e[0],i=e[1],r=e[2],o=t[0],a=t[1],s=t[2];return Math.abs(n-o)<=p.b*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-a)<=p.b*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(r-s)<=p.b*Math.max(1,Math.abs(r),Math.abs(s))};var p=n(2);const m=a;t.sub=m;const v=s;t.mul=v;const g=u;t.div=g;const b=c;t.dist=b;const _=l;t.sqrDist=_;const y=r;t.len=y;const w=h;t.sqrLen=w;const M=function(){let e=i();return function(t,n,i,r,o,a){let s,u;for(n||(n=3),i||(i=0),u=r?Math.min(r*n+i,t.length):t.length,s=i;s<u;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}();t.forEach=M},function(e,t,n){"use strict";function i(){let e=new d.a(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function r(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}function o(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e}function a(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e}function s(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function u(e,t){let n=t[0]-e[0],i=t[1]-e[1],r=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(n*n+i*i+r*r+o*o)}function c(e,t){let n=t[0]-e[0],i=t[1]-e[1],r=t[2]-e[2],o=t[3]-e[3];return n*n+i*i+r*r+o*o}function l(e){let t=e[0],n=e[1],i=e[2],r=e[3];return Math.sqrt(t*t+n*n+i*i+r*r)}function h(e){let t=e[0],n=e[1],i=e[2],r=e[3];return t*t+n*n+i*i+r*r}function f(e,t){let n=t[0],i=t[1],r=t[2],o=t[3],a=n*n+i*i+r*r+o*o;return a>0&&(a=1/Math.sqrt(a),e[0]=n*a,e[1]=i*a,e[2]=r*a,e[3]=o*a),e}Object.defineProperty(t,"__esModule",{value:!0}),t.create=i,t.clone=function(e){let t=new d.a(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.fromValues=function(e,t,n,i){let r=new d.a(4);return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},t.set=function(e,t,n,i,r){return e[0]=t,e[1]=n,e[2]=i,e[3]=r,e},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},t.subtract=r,t.multiply=o,t.divide=a,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},t.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e},t.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},t.scale=s,t.scaleAndAdd=function(e,t,n,i){return e[0]=t[0]+n[0]*i,e[1]=t[1]+n[1]*i,e[2]=t[2]+n[2]*i,e[3]=t[3]+n[3]*i,e},t.distance=u,t.squaredDistance=c,t.length=l,t.squaredLength=h,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},t.normalize=f,t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},t.lerp=function(e,t,n,i){let r=t[0],o=t[1],a=t[2],s=t[3];return e[0]=r+i*(n[0]-r),e[1]=o+i*(n[1]-o),e[2]=a+i*(n[2]-a),e[3]=s+i*(n[3]-s),e},t.random=function(e,t){return t=t||1,e[0]=d.c(),e[1]=d.c(),e[2]=d.c(),e[3]=d.c(),f(e,e),s(e,e,t),e},t.transformMat4=function(e,t,n){let i=t[0],r=t[1],o=t[2],a=t[3];return e[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*a,e[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*a,e[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*a,e[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*a,e},t.transformQuat=function(e,t,n){let i=t[0],r=t[1],o=t[2],a=n[0],s=n[1],u=n[2],c=n[3],l=c*i+s*o-u*r,h=c*r+u*i-a*o,f=c*o+a*r-s*i,d=-a*i-s*r-u*o;return e[0]=l*c+d*-a+h*-u-f*-s,e[1]=h*c+d*-s+f*-a-l*-u,e[2]=f*c+d*-u+l*-s-h*-a,e[3]=t[3],e},t.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(e,t){let n=e[0],i=e[1],r=e[2],o=e[3],a=t[0],s=t[1],u=t[2],c=t[3];return Math.abs(n-a)<=d.b*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-s)<=d.b*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(r-u)<=d.b*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(o-c)<=d.b*Math.max(1,Math.abs(o),Math.abs(c))};var d=n(2);const p=r;t.sub=p;const m=o;t.mul=m;const v=a;t.div=v;const g=u;t.dist=g;const b=c;t.sqrDist=b;const _=l;t.len=_;const y=h;t.sqrLen=y;const w=function(){let e=i();return function(t,n,i,r,o,a){let s,u;for(n||(n=4),i||(i=0),u=r?Math.min(r*n+i,t.length):t.length,s=i;s<u;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}();t.forEach=w},function(e,t,n){"use strict";var i=n(11),r=n(0),o=n(24),a=n(1),s=n(40);class u extends i.a{constructor(e){if(super(),this._debug=e.debug,this._color=e&&e.color||[1,1,1,1],this._intensity=e&&e.intensity||.5,this._positionViewSpace=r.c.create(),e.debug){const e=new o.a(3.2,6),t=Object(a.b)(),n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e.positions),t.STATIC_DRAW);const i=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint32Array(e.indices),t.STATIC_DRAW),this._indexCount=e.indices.length,this.buffers={positions:n,indices:i},this._shader=new s.a}}get positionViewSpace(){return this._positionViewSpace}get color(){return this._color}get intensity(){return this._intensity}set positionViewSpace(e){this._positionViewSpace=e}set color(e){this._color=e}set intensity(e){this._intensity=e}draw(e){console.assert(this._debug);const t=Object(a.b)(),n=this._shader.programInfo;this._shader.activate(),t.uniformMatrix4fv(n.uniformLocations.mvp,!1,e),t.bindBuffer(t.ARRAY_BUFFER,this.buffers.positions),t.enableVertexAttribArray(n.attribLocations.position),t.vertexAttribPointer(n.attribLocations.position,3,t.FLOAT,!1,0,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffers.indices),t.drawElements(t.TRIANGLES,this._indexCount,t.UNSIGNED_INT,0)}}t.a=u},function(e,t,n){"use strict";var i=n(12);class r{constructor(e,t=0){const n=.5+Math.sqrt(5)/2;let r=[-1,+n,0,1,+n,0,-1,-n,0,1,-n,0,0,-1,+n,0,1,+n,0,-1,-n,0,1,-n,+n,0,-1,+n,0,1,-n,0,-1,-n,0,1];const o=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a=[];let s={faces:Object(i.d)(o,3),positions:Object(i.d)(r,3)},u=Math.min(t,3);for(;u-- >0;)s=this.subdivide(s);for(let e=0;e<s.positions.length;e++){const t=this.normalize(s.positions[e]),n=.5*(-Math.atan2(t[2],-t[0])/Math.PI+1),i=.5+Math.asin(t[1])/Math.PI;a.push([1-n,1-i])}r=s.positions;for(let t=0;t<r.length;t++)this.scale(r[t],e);const c={positions:Object(i.a)(s.positions),indices:Object(i.a)(s.faces),normals:null,uvs:Object(i.a)(a,2)};return c.normals=Object(i.b)(c.positions,c.indices),c}fixPoleUVs(e,t,n){function i(t,i,r,o){const c=n[r],l=n[o];n[i][0]=(c[0]+l[0])/2,u++,a.push(e[i].slice()),s.push(n[i].slice()),t[0]=u}const r=this.firstYIndex(e,1),o=this.firstYIndex(e,-1);if(-1===r||-1===o)return;const a=e.slice(),s=n.slice();let u=a.length-1;for(let e=0;e<t.length;++e){const n=t[e],a=n[0],s=n[1],u=n[2];a===r?i(n,r,s,u):a===o&&i(n,o,s,u)}e=a,n=s}firstYIndex(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(Math.abs(i[1]-t)<=1e-4)return n}return-1}normalize(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n]*e[n];if(0===(t=Math.sqrt(t)))return Array.apply(null,new Array(e.length)).map(Number.prototype.valueOf,0);for(let n=0;n<e.length;n++)e[n]/=t;return e}scale(e,t){for(let n=0;n<e.length;n++)e[n]*=t;return e}subdivide(e){function t(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2,(e[2]+t[2])/2]}function n(e){return`${e[0].toPrecision(6)},${e[1].toPrecision(6)},${e[2].toPrecision(6)}`}function i(e,i){const r=t(e,i),o=n(r),a=u[o];return a||(u[o]=r,u[o])}const{positions:r,faces:o}=e,a=[],s=[],u={};let c=0;for(let e=0;e<o.length;e++){const t=o[e],n=t[0],u=t[1],l=t[2],h=r[n],f=r[u],d=r[l],p=i(h,f),m=i(f,d),v=i(d,h);let g=s.indexOf(p);-1===g&&(g=c++,s.push(p));let b=s.indexOf(m);-1===b&&(b=c++,s.push(m));let _=s.indexOf(v);-1===_&&(_=c++,s.push(v));let y=s.indexOf(h);-1===y&&(y=c++,s.push(h));let w=s.indexOf(f);-1===w&&(w=c++,s.push(f));let M=s.indexOf(d);-1===M&&(M=c++,s.push(d)),a.push([y,g,_]),a.push([w,b,g]),a.push([M,_,b]),a.push([g,b,_])}return{faces:a,positions:s}}}t.a=r},function(e,t,n){function i(){r.call(this)}e.exports=i;var r=n(13).EventEmitter;n(6)(i,r),i.Readable=n(14),i.Writable=n(64),i.Duplex=n(65),i.Transform=n(66),i.PassThrough=n(67),i.Stream=i,i.prototype.pipe=function(e,t){function n(t){e.writable&&!1===e.write(t)&&c.pause&&c.pause()}function i(){c.readable&&c.resume&&c.resume()}function o(){l||(l=!0,e.end())}function a(){l||(l=!0,"function"==typeof e.destroy&&e.destroy())}function s(e){if(u(),0===r.listenerCount(this,"error"))throw e}function u(){c.removeListener("data",n),e.removeListener("drain",i),c.removeListener("end",o),c.removeListener("close",a),c.removeListener("error",s),e.removeListener("error",s),c.removeListener("end",u),c.removeListener("close",u),e.removeListener("close",u)}var c=this;c.on("data",n),e.on("drain",i),e._isStdio||t&&!1===t.end||(c.on("end",o),c.on("close",a));var l=!1;return c.on("error",s),e.on("error",s),c.on("end",u),c.on("close",u),e.on("close",u),e.emit("pipe",c),e}},function(e,t,n){"use strict";(function(t,i){function r(e){return D.from(e)}function o(e){return D.isBuffer(e)||e instanceof U}function a(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?B(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}function s(e,t){O=O||n(4),e=e||{},this.objectMode=!!e.objectMode,t instanceof O&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var i=e.highWaterMark,r=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new H,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(z||(z=n(18).StringDecoder),this.decoder=new z(e.encoding),this.encoding=e.encoding)}function u(e){if(O=O||n(4),!(this instanceof u))return new u(e);this._readableState=new s(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),N.call(this)}function c(e,t,n,i,o){var a=e._readableState;if(null===t)a.reading=!1,m(e,a);else{var s;o||(s=h(a,t)),s?e.emit("error",s):a.objectMode||t&&t.length>0?("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===D.prototype||(t=r(t)),i?a.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):l(e,a,t,!0):a.ended?e.emit("error",new Error("stream.push() after EOF")):(a.reading=!1,a.decoder&&!n?(t=a.decoder.write(t),a.objectMode||0!==t.length?l(e,a,t,!1):b(e,a)):l(e,a,t,!1))):i||(a.reading=!1)}return f(a)}function l(e,t,n,i){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&v(e)),b(e,t)}function h(e,t){var n;return o(t)||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function f(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function d(e){return e>=X?e=X:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function p(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=d(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function m(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,v(e)}}function v(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(V("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?I(g,e):g(e))}function g(e){V("emit readable"),e.emit("readable"),S(e)}function b(e,t){t.readingMore||(t.readingMore=!0,I(_,e,t))}function _(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(V("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function y(e){return function(){var t=e._readableState;V("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&P(e,"data")&&(t.flowing=!0,S(e))}}function w(e){V("readable nexttick read 0"),e.read(0)}function M(e,t){t.resumeScheduled||(t.resumeScheduled=!0,I(x,e,t))}function x(e,t){t.reading||(V("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),S(e),t.flowing&&!t.reading&&e.read(0)}function S(e){var t=e._readableState;for(V("flow",t.flowing);t.flowing&&null!==e.read(););}function E(e,t){if(0===t.length)return null;var n;return t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=A(e,t.buffer,t.decoder),n}function A(e,t,n){var i;return e<t.head.data.length?(i=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):i=e===t.head.data.length?t.shift():n?L(e,t):T(e,t),i}function L(e,t){var n=t.head,i=1,r=n.data;for(e-=r.length;n=n.next;){var o=n.data,a=e>o.length?o.length:e;if(a===o.length?r+=o:r+=o.slice(0,e),0===(e-=a)){a===o.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(a));break}++i}return t.length-=i,r}function T(e,t){var n=D.allocUnsafe(e),i=t.head,r=1;for(i.data.copy(n),e-=i.data.length;i=i.next;){var o=i.data,a=e>o.length?o.length:e;if(o.copy(n,n.length-e,0,a),0===(e-=a)){a===o.length?(++r,i.next?t.head=i.next:t.head=t.tail=null):(t.head=i,i.data=o.slice(a));break}++r}return t.length-=r,n}function R(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,I(k,t,e))}function k(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function C(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1}var I=n(10);e.exports=u;var O,B=n(27);u.ReadableState=s;n(13).EventEmitter;var P=function(e,t){return e.listeners(t).length},N=n(28),D=n(15).Buffer,U=t.Uint8Array||function(){},F=n(8);F.inherits=n(6);var j=n(58),V=void 0;V=j&&j.debuglog?j.debuglog("stream"):function(){};var z,H=n(59),q=n(29);F.inherits(u,N);var Y=["error","close","destroy","pause","resume"];Object.defineProperty(u.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),u.prototype.destroy=q.destroy,u.prototype._undestroy=q.undestroy,u.prototype._destroy=function(e,t){this.push(null),t(e)},u.prototype.push=function(e,t){var n,i=this._readableState;return i.objectMode?n=!0:"string"==typeof e&&((t=t||i.defaultEncoding)!==i.encoding&&(e=D.from(e,t),t=""),n=!0),c(this,e,t,!1,n)},u.prototype.unshift=function(e){return c(this,e,null,!0,!1)},u.prototype.isPaused=function(){return!1===this._readableState.flowing},u.prototype.setEncoding=function(e){return z||(z=n(18).StringDecoder),this._readableState.decoder=new z(e),this._readableState.encoding=e,this};var X=8388608;u.prototype.read=function(e){V("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return V("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?R(this):v(this),null;if(0===(e=p(e,t))&&t.ended)return 0===t.length&&R(this),null;var i=t.needReadable;V("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&V("length less than watermark",i=!0),t.ended||t.reading?V("reading or ended",i=!1):i&&(V("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=p(n,t)));var r;return null===(r=e>0?E(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&R(this)),null!==r&&this.emit("data",r),r},u.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},u.prototype.pipe=function(e,t){function n(e,t){V("onunpipe"),e===f&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,o())}function r(){V("onend"),e.end()}function o(){V("cleanup"),e.removeListener("close",c),e.removeListener("finish",l),e.removeListener("drain",m),e.removeListener("error",u),e.removeListener("unpipe",n),f.removeListener("end",r),f.removeListener("end",h),f.removeListener("data",s),v=!0,!d.awaitDrain||e._writableState&&!e._writableState.needDrain||m()}function s(t){V("ondata"),g=!1,!1!==e.write(t)||g||((1===d.pipesCount&&d.pipes===e||d.pipesCount>1&&-1!==C(d.pipes,e))&&!v&&(V("false write response, pause",f._readableState.awaitDrain),f._readableState.awaitDrain++,g=!0),f.pause())}function u(t){V("onerror",t),h(),e.removeListener("error",u),0===P(e,"error")&&e.emit("error",t)}function c(){e.removeListener("finish",l),h()}function l(){V("onfinish"),e.removeListener("close",c),h()}function h(){V("unpipe"),f.unpipe(e)}var f=this,d=this._readableState;switch(d.pipesCount){case 0:d.pipes=e;break;case 1:d.pipes=[d.pipes,e];break;default:d.pipes.push(e)}d.pipesCount+=1,V("pipe count=%d opts=%j",d.pipesCount,t);var p=(!t||!1!==t.end)&&e!==i.stdout&&e!==i.stderr?r:h;d.endEmitted?I(p):f.once("end",p),e.on("unpipe",n);var m=y(f);e.on("drain",m);var v=!1,g=!1;return f.on("data",s),a(e,"error",u),e.once("close",c),e.once("finish",l),e.emit("pipe",f),d.flowing||(V("pipe resume"),f.resume()),e},u.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n),this);if(!e){var i=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<r;o++)i[o].emit("unpipe",this,n);return this}var a=C(t.pipes,e);return-1===a?this:(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n),this)},u.prototype.on=function(e,t){var n=N.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&v(this):I(w,this))}return n},u.prototype.addListener=u.prototype.on,u.prototype.resume=function(){var e=this._readableState;return e.flowing||(V("resume"),e.flowing=!0,M(this,e)),this},u.prototype.pause=function(){return V("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(V("pause"),this._readableState.flowing=!1,this.emit("pause")),this},u.prototype.wrap=function(e){var t=this._readableState,n=!1,i=this;e.on("end",function(){if(V("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&i.push(e)}i.push(null)}),e.on("data",function(r){V("wrapped data"),t.decoder&&(r=t.decoder.write(r)),(!t.objectMode||null!==r&&void 0!==r)&&(t.objectMode||r&&r.length)&&(i.push(r)||(n=!0,e.pause()))});for(var r in e)void 0===this[r]&&"function"==typeof e[r]&&(this[r]=function(t){return function(){return e[t].apply(e,arguments)}}(r));for(var o=0;o<Y.length;o++)e.on(Y[o],i.emit.bind(i,Y[o]));return i._read=function(t){V("wrapped _read",t),n&&(n=!1,e.resume())},i},u._fromList=E}).call(t,n(3),n(7))},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){e.exports=n(13).EventEmitter},function(e,t,n){"use strict";function i(e,t){e.emit("error",t)}var r=n(10);e.exports={destroy:function(e,t){var n=this,o=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;o||a?t?t(e):!e||this._writableState&&this._writableState.errorEmitted||r(i,this,e):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(r(i,n,e),n._writableState&&(n._writableState.errorEmitted=!0)):t&&t(e)}))},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,n){"use strict";function i(e){this.afterTransform=function(t,n){return r(e,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function r(e,t,n){var i=e._transformState;i.transforming=!1;var r=i.writecb;if(!r)return e.emit("error",new Error("write callback called multiple times"));i.writechunk=null,i.writecb=null,null!==n&&void 0!==n&&e.push(n),r(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark)}function o(e){if(!(this instanceof o))return new o(e);s.call(this,e),this._transformState=new i(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(e,n){a(t,e,n)}):a(t)})}function a(e,t,n){if(t)return e.emit("error",t);null!==n&&void 0!==n&&e.push(n);var i=e._writableState,r=e._transformState;if(i.length)throw new Error("Calling transform done when ws.length != 0");if(r.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}e.exports=o;var s=n(4),u=n(8);u.inherits=n(6),u.inherits(o,s),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,s.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},o.prototype._write=function(e,t,n){var i=this._transformState;if(i.writecb=n,i.writechunk=e,i.writeencoding=t,!i.transforming){var r=this._readableState;(i.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},o.prototype._destroy=function(e,t){var n=this;s.prototype._destroy.call(this,e,function(e){t(e),n.emit("close")})}},function(e,t){e.exports=function(e){var t=n.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)};var n=Object.prototype.toString},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"BasicMaterial",function(){return BasicMaterial});var i=n(1),r=n(42),o=n(24),a=n(19),s=n(43),u=n(47),c=n(48),l=n(49),h=n(50),f=n(51),d=n(23),p=n(52),m=n(54),v=n(76);n.d(t,"PhongMaterial",function(){return c.a}),n.d(t,"LambertMaterial",function(){return l.a}),n.d(t,"ObjectLoader",function(){return p.a}),n.d(t,"Renderer",function(){return i.a}),n.d(t,"Cube",function(){return r.a}),n.d(t,"Sphere",function(){return o.a}),n.d(t,"Mesh",function(){return s.a}),n.d(t,"Scene",function(){return a.a}),n.d(t,"MaterialLoader",function(){return m.a}),n.d(t,"PerspectiveCamera",function(){return u.a}),n.d(t,"OrbitControls",function(){return h.a}),n.d(t,"FlyControls",function(){return f.a}),n.d(t,"PointLight",function(){return d.a}),n.d(t,"ResourceLoader",function(){return v.a}),Object.defineProperty(Float32Array.prototype,"x",{get:function(){return this[0]},set:function(e){this[0]=e}}),Object.defineProperty(Float32Array.prototype,"y",{get:function(){return this[1]},set:function(e){this[1]=e}}),Object.defineProperty(Float32Array.prototype,"z",{get:function(){return this[2]},set:function(e){this[2]=e}})},function(e,t,n){"use strict";n(2)},function(e,t,n){"use strict";n(2)},function(e,t,n){"use strict";function i(e,t,n){let i=t[0],r=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],h=t[8],f=t[9],d=t[10],p=t[11],m=t[12],v=t[13],g=t[14],b=t[15],_=n[0],y=n[1],w=n[2],M=n[3];return e[0]=_*i+y*s+w*h+M*m,e[1]=_*r+y*u+w*f+M*v,e[2]=_*o+y*c+w*d+M*g,e[3]=_*a+y*l+w*p+M*b,_=n[4],y=n[5],w=n[6],M=n[7],e[4]=_*i+y*s+w*h+M*m,e[5]=_*r+y*u+w*f+M*v,e[6]=_*o+y*c+w*d+M*g,e[7]=_*a+y*l+w*p+M*b,_=n[8],y=n[9],w=n[10],M=n[11],e[8]=_*i+y*s+w*h+M*m,e[9]=_*r+y*u+w*f+M*v,e[10]=_*o+y*c+w*d+M*g,e[11]=_*a+y*l+w*p+M*b,_=n[12],y=n[13],w=n[14],M=n[15],e[12]=_*i+y*s+w*h+M*m,e[13]=_*r+y*u+w*f+M*v,e[14]=_*o+y*c+w*d+M*g,e[15]=_*a+y*l+w*p+M*b,e}function r(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}Object.defineProperty(t,"__esModule",{value:!0}),t.create=function(){let e=new o.a(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.clone=function(e){let t=new o.a(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.fromValues=function(e,t,n,i,r,a,s,u,c,l,h,f,d,p,m,v){let g=new o.a(16);return g[0]=e,g[1]=t,g[2]=n,g[3]=i,g[4]=r,g[5]=a,g[6]=s,g[7]=u,g[8]=c,g[9]=l,g[10]=h,g[11]=f,g[12]=d,g[13]=p,g[14]=m,g[15]=v,g},t.set=function(e,t,n,i,r,o,a,s,u,c,l,h,f,d,p,m,v){return e[0]=t,e[1]=n,e[2]=i,e[3]=r,e[4]=o,e[5]=a,e[6]=s,e[7]=u,e[8]=c,e[9]=l,e[10]=h,e[11]=f,e[12]=d,e[13]=p,e[14]=m,e[15]=v,e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.transpose=function(e,t){if(e===t){let n=t[1],i=t[2],r=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=i,e[9]=o,e[11]=t[14],e[12]=r,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},t.invert=function(e,t){let n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],h=t[9],f=t[10],d=t[11],p=t[12],m=t[13],v=t[14],g=t[15],b=n*s-i*a,_=n*u-r*a,y=n*c-o*a,w=i*u-r*s,M=i*c-o*s,x=r*c-o*u,S=l*m-h*p,E=l*v-f*p,A=l*g-d*p,L=h*v-f*m,T=h*g-d*m,R=f*g-d*v,k=b*R-_*T+y*L+w*A-M*E+x*S;return k?(k=1/k,e[0]=(s*R-u*T+c*L)*k,e[1]=(r*T-i*R-o*L)*k,e[2]=(m*x-v*M+g*w)*k,e[3]=(f*M-h*x-d*w)*k,e[4]=(u*A-a*R-c*E)*k,e[5]=(n*R-r*A+o*E)*k,e[6]=(v*y-p*x-g*_)*k,e[7]=(l*x-f*y+d*_)*k,e[8]=(a*T-s*A+c*S)*k,e[9]=(i*A-n*T-o*S)*k,e[10]=(p*M-m*y+g*b)*k,e[11]=(h*y-l*M-d*b)*k,e[12]=(s*E-a*L-u*S)*k,e[13]=(n*L-i*E+r*S)*k,e[14]=(m*_-p*w-v*b)*k,e[15]=(l*w-h*_+f*b)*k,e):null},t.adjoint=function(e,t){let n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],h=t[9],f=t[10],d=t[11],p=t[12],m=t[13],v=t[14],g=t[15];return e[0]=s*(f*g-d*v)-h*(u*g-c*v)+m*(u*d-c*f),e[1]=-(i*(f*g-d*v)-h*(r*g-o*v)+m*(r*d-o*f)),e[2]=i*(u*g-c*v)-s*(r*g-o*v)+m*(r*c-o*u),e[3]=-(i*(u*d-c*f)-s*(r*d-o*f)+h*(r*c-o*u)),e[4]=-(a*(f*g-d*v)-l*(u*g-c*v)+p*(u*d-c*f)),e[5]=n*(f*g-d*v)-l*(r*g-o*v)+p*(r*d-o*f),e[6]=-(n*(u*g-c*v)-a*(r*g-o*v)+p*(r*c-o*u)),e[7]=n*(u*d-c*f)-a*(r*d-o*f)+l*(r*c-o*u),e[8]=a*(h*g-d*m)-l*(s*g-c*m)+p*(s*d-c*h),e[9]=-(n*(h*g-d*m)-l*(i*g-o*m)+p*(i*d-o*h)),e[10]=n*(s*g-c*m)-a*(i*g-o*m)+p*(i*c-o*s),e[11]=-(n*(s*d-c*h)-a*(i*d-o*h)+l*(i*c-o*s)),e[12]=-(a*(h*v-f*m)-l*(s*v-u*m)+p*(s*f-u*h)),e[13]=n*(h*v-f*m)-l*(i*v-r*m)+p*(i*f-r*h),e[14]=-(n*(s*v-u*m)-a*(i*v-r*m)+p*(i*u-r*s)),e[15]=n*(s*f-u*h)-a*(i*f-r*h)+l*(i*u-r*s),e},t.determinant=function(e){let t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],h=e[10],f=e[11],d=e[12],p=e[13],m=e[14],v=e[15];return(t*a-n*o)*(h*v-f*m)-(t*s-i*o)*(l*v-f*p)+(t*u-r*o)*(l*m-h*p)+(n*s-i*a)*(c*v-f*d)-(n*u-r*a)*(c*m-h*d)+(i*u-r*s)*(c*p-l*d)},t.multiply=i,t.translate=function(e,t,n){let i,r,o,a,s,u,c,l,h,f,d,p,m=n[0],v=n[1],g=n[2];return t===e?(e[12]=t[0]*m+t[4]*v+t[8]*g+t[12],e[13]=t[1]*m+t[5]*v+t[9]*g+t[13],e[14]=t[2]*m+t[6]*v+t[10]*g+t[14],e[15]=t[3]*m+t[7]*v+t[11]*g+t[15]):(i=t[0],r=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],h=t[8],f=t[9],d=t[10],p=t[11],e[0]=i,e[1]=r,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=c,e[7]=l,e[8]=h,e[9]=f,e[10]=d,e[11]=p,e[12]=i*m+s*v+h*g+t[12],e[13]=r*m+u*v+f*g+t[13],e[14]=o*m+c*v+d*g+t[14],e[15]=a*m+l*v+p*g+t[15]),e},t.scale=function(e,t,n){let i=n[0],r=n[1],o=n[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.rotate=function(e,t,n,i){let r,a,s,u,c,l,h,f,d,p,m,v,g,b,_,y,w,M,x,S,E,A,L,T,R=i[0],k=i[1],C=i[2],I=Math.sqrt(R*R+k*k+C*C);return Math.abs(I)<o.b?null:(I=1/I,R*=I,k*=I,C*=I,r=Math.sin(n),a=Math.cos(n),s=1-a,u=t[0],c=t[1],l=t[2],h=t[3],f=t[4],d=t[5],p=t[6],m=t[7],v=t[8],g=t[9],b=t[10],_=t[11],y=R*R*s+a,w=k*R*s+C*r,M=C*R*s-k*r,x=R*k*s-C*r,S=k*k*s+a,E=C*k*s+R*r,A=R*C*s+k*r,L=k*C*s-R*r,T=C*C*s+a,e[0]=u*y+f*w+v*M,e[1]=c*y+d*w+g*M,e[2]=l*y+p*w+b*M,e[3]=h*y+m*w+_*M,e[4]=u*x+f*S+v*E,e[5]=c*x+d*S+g*E,e[6]=l*x+p*S+b*E,e[7]=h*x+m*S+_*E,e[8]=u*A+f*L+v*T,e[9]=c*A+d*L+g*T,e[10]=l*A+p*L+b*T,e[11]=h*A+m*L+_*T,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},t.rotateX=function(e,t,n){let i=Math.sin(n),r=Math.cos(n),o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],h=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*r+c*i,e[5]=a*r+l*i,e[6]=s*r+h*i,e[7]=u*r+f*i,e[8]=c*r-o*i,e[9]=l*r-a*i,e[10]=h*r-s*i,e[11]=f*r-u*i,e},t.rotateY=function(e,t,n){let i=Math.sin(n),r=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],c=t[8],l=t[9],h=t[10],f=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*r-c*i,e[1]=a*r-l*i,e[2]=s*r-h*i,e[3]=u*r-f*i,e[8]=o*i+c*r,e[9]=a*i+l*r,e[10]=s*i+h*r,e[11]=u*i+f*r,e},t.rotateZ=function(e,t,n){let i=Math.sin(n),r=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],c=t[4],l=t[5],h=t[6],f=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*r+c*i,e[1]=a*r+l*i,e[2]=s*r+h*i,e[3]=u*r+f*i,e[4]=c*r-o*i,e[5]=l*r-a*i,e[6]=h*r-s*i,e[7]=f*r-u*i,e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotation=function(e,t,n){let i,r,a,s=n[0],u=n[1],c=n[2],l=Math.sqrt(s*s+u*u+c*c);return Math.abs(l)<o.b?null:(l=1/l,s*=l,u*=l,c*=l,i=Math.sin(t),r=Math.cos(t),a=1-r,e[0]=s*s*a+r,e[1]=u*s*a+c*i,e[2]=c*s*a-u*i,e[3]=0,e[4]=s*u*a-c*i,e[5]=u*u*a+r,e[6]=c*u*a+s*i,e[7]=0,e[8]=s*c*a+u*i,e[9]=u*c*a-s*i,e[10]=c*c*a+r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},t.fromXRotation=function(e,t){let n=Math.sin(t),i=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromYRotation=function(e,t){let n=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromZRotation=function(e,t){let n=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotationTranslation=function(e,t,n){let i=t[0],r=t[1],o=t[2],a=t[3],s=i+i,u=r+r,c=o+o,l=i*s,h=i*u,f=i*c,d=r*u,p=r*c,m=o*c,v=a*s,g=a*u,b=a*c;return e[0]=1-(d+m),e[1]=h+b,e[2]=f-g,e[3]=0,e[4]=h-b,e[5]=1-(l+m),e[6]=p+v,e[7]=0,e[8]=f+g,e[9]=p-v,e[10]=1-(l+d),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e},t.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},t.getScaling=function(e,t){let n=t[0],i=t[1],r=t[2],o=t[4],a=t[5],s=t[6],u=t[8],c=t[9],l=t[10];return e[0]=Math.sqrt(n*n+i*i+r*r),e[1]=Math.sqrt(o*o+a*a+s*s),e[2]=Math.sqrt(u*u+c*c+l*l),e},t.getRotation=function(e,t){let n=t[0]+t[5]+t[10],i=0;return n>0?(i=2*Math.sqrt(n+1),e[3]=.25*i,e[0]=(t[6]-t[9])/i,e[1]=(t[8]-t[2])/i,e[2]=(t[1]-t[4])/i):t[0]>t[5]&t[0]>t[10]?(i=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/i,e[0]=.25*i,e[1]=(t[1]+t[4])/i,e[2]=(t[8]+t[2])/i):t[5]>t[10]?(i=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/i,e[0]=(t[1]+t[4])/i,e[1]=.25*i,e[2]=(t[6]+t[9])/i):(i=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/i,e[0]=(t[8]+t[2])/i,e[1]=(t[6]+t[9])/i,e[2]=.25*i),e},t.fromRotationTranslationScale=function(e,t,n,i){let r=t[0],o=t[1],a=t[2],s=t[3],u=r+r,c=o+o,l=a+a,h=r*u,f=r*c,d=r*l,p=o*c,m=o*l,v=a*l,g=s*u,b=s*c,_=s*l,y=i[0],w=i[1],M=i[2];return e[0]=(1-(p+v))*y,e[1]=(f+_)*y,e[2]=(d-b)*y,e[3]=0,e[4]=(f-_)*w,e[5]=(1-(h+v))*w,e[6]=(m+g)*w,e[7]=0,e[8]=(d+b)*M,e[9]=(m-g)*M,e[10]=(1-(h+p))*M,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e},t.fromRotationTranslationScaleOrigin=function(e,t,n,i,r){let o=t[0],a=t[1],s=t[2],u=t[3],c=o+o,l=a+a,h=s+s,f=o*c,d=o*l,p=o*h,m=a*l,v=a*h,g=s*h,b=u*c,_=u*l,y=u*h,w=i[0],M=i[1],x=i[2],S=r[0],E=r[1],A=r[2];return e[0]=(1-(m+g))*w,e[1]=(d+y)*w,e[2]=(p-_)*w,e[3]=0,e[4]=(d-y)*M,e[5]=(1-(f+g))*M,e[6]=(v+b)*M,e[7]=0,e[8]=(p+_)*x,e[9]=(v-b)*x,e[10]=(1-(f+m))*x,e[11]=0,e[12]=n[0]+S-(e[0]*S+e[4]*E+e[8]*A),e[13]=n[1]+E-(e[1]*S+e[5]*E+e[9]*A),e[14]=n[2]+A-(e[2]*S+e[6]*E+e[10]*A),e[15]=1,e},t.fromQuat=function(e,t){let n=t[0],i=t[1],r=t[2],o=t[3],a=n+n,s=i+i,u=r+r,c=n*a,l=i*a,h=i*s,f=r*a,d=r*s,p=r*u,m=o*a,v=o*s,g=o*u;return e[0]=1-h-p,e[1]=l+g,e[2]=f-v,e[3]=0,e[4]=l-g,e[5]=1-c-p,e[6]=d+m,e[7]=0,e[8]=f+v,e[9]=d-m,e[10]=1-c-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.frustum=function(e,t,n,i,r,o,a){let s=1/(n-t),u=1/(r-i),c=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*u,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(r+i)*u,e[10]=(a+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*c,e[15]=0,e},t.perspective=function(e,t,n,i,r){let o=1/Math.tan(t/2),a=1/(i-r);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(r+i)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*r*i*a,e[15]=0,e},t.perspectiveFromFieldOfView=function(e,t,n,i){let r=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(a+s),c=2/(r+o);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(a-s)*u*.5,e[9]=(r-o)*c*.5,e[10]=i/(n-i),e[11]=-1,e[12]=0,e[13]=0,e[14]=i*n/(n-i),e[15]=0,e},t.ortho=function(e,t,n,i,r,o,a){let s=1/(t-n),u=1/(i-r),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*s,e[13]=(r+i)*u,e[14]=(a+o)*c,e[15]=1,e},t.lookAt=function(e,t,n,i){let r,a,s,u,c,l,h,f,d,p,m=t[0],v=t[1],g=t[2],b=i[0],_=i[1],y=i[2],w=n[0],M=n[1],x=n[2];return Math.abs(m-w)<o.b&&Math.abs(v-M)<o.b&&Math.abs(g-x)<o.b?mat4.identity(e):(h=m-w,f=v-M,d=g-x,p=1/Math.sqrt(h*h+f*f+d*d),h*=p,f*=p,d*=p,r=_*d-y*f,a=y*h-b*d,s=b*f-_*h,(p=Math.sqrt(r*r+a*a+s*s))?(r*=p=1/p,a*=p,s*=p):(r=0,a=0,s=0),u=f*s-d*a,c=d*r-h*s,l=h*a-f*r,(p=Math.sqrt(u*u+c*c+l*l))?(u*=p=1/p,c*=p,l*=p):(u=0,c=0,l=0),e[0]=r,e[1]=u,e[2]=h,e[3]=0,e[4]=a,e[5]=c,e[6]=f,e[7]=0,e[8]=s,e[9]=l,e[10]=d,e[11]=0,e[12]=-(r*m+a*v+s*g),e[13]=-(u*m+c*v+l*g),e[14]=-(h*m+f*v+d*g),e[15]=1,e)},t.targetTo=function(e,t,n,i){let r=t[0],o=t[1],a=t[2],s=i[0],u=i[1],c=i[2],l=r-n[0],h=o-n[1],f=a-n[2],d=l*l+h*h+f*f;d>0&&(l*=d=1/Math.sqrt(d),h*=d,f*=d);let p=u*f-c*h,m=c*l-s*f,v=s*h-u*l;return e[0]=p,e[1]=m,e[2]=v,e[3]=0,e[4]=h*v-f*m,e[5]=f*p-l*v,e[6]=l*m-h*p,e[7]=0,e[8]=l,e[9]=h,e[10]=f,e[11]=0,e[12]=r,e[13]=o,e[14]=a,e[15]=1,e},t.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e},t.subtract=r,t.multiplyScalar=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e},t.multiplyScalarAndAdd=function(e,t,n,i){return e[0]=t[0]+n[0]*i,e[1]=t[1]+n[1]*i,e[2]=t[2]+n[2]*i,e[3]=t[3]+n[3]*i,e[4]=t[4]+n[4]*i,e[5]=t[5]+n[5]*i,e[6]=t[6]+n[6]*i,e[7]=t[7]+n[7]*i,e[8]=t[8]+n[8]*i,e[9]=t[9]+n[9]*i,e[10]=t[10]+n[10]*i,e[11]=t[11]+n[11]*i,e[12]=t[12]+n[12]*i,e[13]=t[13]+n[13]*i,e[14]=t[14]+n[14]*i,e[15]=t[15]+n[15]*i,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},t.equals=function(e,t){let n=e[0],i=e[1],r=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],d=e[10],p=e[11],m=e[12],v=e[13],g=e[14],b=e[15],_=t[0],y=t[1],w=t[2],M=t[3],x=t[4],S=t[5],E=t[6],A=t[7],L=t[8],T=t[9],R=t[10],k=t[11],C=t[12],I=t[13],O=t[14],B=t[15];return Math.abs(n-_)<=o.b*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(i-y)<=o.b*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(r-w)<=o.b*Math.max(1,Math.abs(r),Math.abs(w))&&Math.abs(a-M)<=o.b*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(s-x)<=o.b*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(u-S)<=o.b*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(c-E)<=o.b*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(l-A)<=o.b*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(h-L)<=o.b*Math.max(1,Math.abs(h),Math.abs(L))&&Math.abs(f-T)<=o.b*Math.max(1,Math.abs(f),Math.abs(T))&&Math.abs(d-R)<=o.b*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(p-k)<=o.b*Math.max(1,Math.abs(p),Math.abs(k))&&Math.abs(m-C)<=o.b*Math.max(1,Math.abs(m),Math.abs(C))&&Math.abs(v-I)<=o.b*Math.max(1,Math.abs(v),Math.abs(I))&&Math.abs(g-O)<=o.b*Math.max(1,Math.abs(g),Math.abs(O))&&Math.abs(b-B)<=o.b*Math.max(1,Math.abs(b),Math.abs(B))};var o=n(2);const a=i;t.mul=a;const s=r;t.sub=s},function(e,t,n){"use strict";function i(){let e=new u.a(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function r(e,t,n){n*=.5;let i=Math.sin(n);return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=Math.cos(n),e}function o(e,t,n){let i=t[0],r=t[1],o=t[2],a=t[3],s=n[0],u=n[1],c=n[2],l=n[3];return e[0]=i*l+a*s+r*c-o*u,e[1]=r*l+a*u+o*s-i*c,e[2]=o*l+a*c+i*u-r*s,e[3]=a*l-i*s-r*u-o*c,e}function a(e,t,n,i){let r,o,a,s,u,c=t[0],l=t[1],h=t[2],f=t[3],d=n[0],p=n[1],m=n[2],v=n[3];return(o=c*d+l*p+h*m+f*v)<0&&(o=-o,d=-d,p=-p,m=-m,v=-v),1-o>1e-6?(r=Math.acos(o),a=Math.sin(r),s=Math.sin((1-i)*r)/a,u=Math.sin(i*r)/a):(s=1-i,u=i),e[0]=s*c+u*d,e[1]=s*l+u*p,e[2]=s*h+u*m,e[3]=s*f+u*v,e}function s(e,t){let n,i=t[0]+t[4]+t[8];if(i>0)n=Math.sqrt(i+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{let i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);let r=(i+1)%3,o=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*r+r]-t[3*o+o]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*r+o]-t[3*o+r])*n,e[r]=(t[3*r+i]+t[3*i+r])*n,e[o]=(t[3*o+i]+t[3*i+o])*n}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.create=i,t.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},t.setAxisAngle=r,t.getAxisAngle=function(e,t){let n=2*Math.acos(t[3]),i=Math.sin(n/2);return 0!=i?(e[0]=t[0]/i,e[1]=t[1]/i,e[2]=t[2]/i):(e[0]=1,e[1]=0,e[2]=0),n},t.multiply=o,t.rotateX=function(e,t,n){n*=.5;let i=t[0],r=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=i*u+a*s,e[1]=r*u+o*s,e[2]=o*u-r*s,e[3]=a*u-i*s,e},t.rotateY=function(e,t,n){n*=.5;let i=t[0],r=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=i*u-o*s,e[1]=r*u+a*s,e[2]=o*u+i*s,e[3]=a*u-r*s,e},t.rotateZ=function(e,t,n){n*=.5;let i=t[0],r=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=i*u+r*s,e[1]=r*u-i*s,e[2]=o*u+a*s,e[3]=a*u-o*s,e},t.calculateW=function(e,t){let n=t[0],i=t[1],r=t[2];return e[0]=n,e[1]=i,e[2]=r,e[3]=Math.sqrt(Math.abs(1-n*n-i*i-r*r)),e},t.slerp=a,t.invert=function(e,t){let n=t[0],i=t[1],r=t[2],o=t[3],a=n*n+i*i+r*r+o*o,s=a?1/a:0;return e[0]=-n*s,e[1]=-i*s,e[2]=-r*s,e[3]=o*s,e},t.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},t.fromMat3=s,t.fromEuler=function(e,t,n,i){let r=.5*Math.PI/180;t*=r,n*=r,i*=r;let o=Math.sin(t),a=Math.cos(t),s=Math.sin(n),u=Math.cos(n),c=Math.sin(i),l=Math.cos(i);return e[0]=o*u*l-a*s*c,e[1]=a*s*l+o*u*c,e[2]=a*u*c-o*s*l,e[3]=a*u*l+o*s*c,e},t.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"};var u=n(2),c=n(20),l=n(21),h=n(22);const f=h.clone;t.clone=f;const d=h.fromValues;t.fromValues=d;const p=h.copy;t.copy=p;const m=h.set;t.set=m;const v=h.add;t.add=v;const g=o;t.mul=g;const b=h.scale;t.scale=b;const _=h.dot;t.dot=_;const y=h.lerp;t.lerp=y;const w=h.length;t.length=w;const M=w;t.len=M;const x=h.squaredLength;t.squaredLength=x;const S=x;t.sqrLen=S;const E=h.normalize;t.normalize=E;const A=h.exactEquals;t.exactEquals=A;const L=h.equals;t.equals=L;const T=function(){let e=l.create(),t=l.fromValues(1,0,0),n=l.fromValues(0,1,0);return function(i,o,a){let s=l.dot(o,a);return s<-.999999?(l.cross(e,t,o),l.len(e)<1e-6&&l.cross(e,n,o),l.normalize(e,e),r(i,e,Math.PI),i):s>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(l.cross(e,o,a),i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=1+s,E(i,i))}}();t.rotationTo=T;const R=function(){let e=i(),t=i();return function(n,i,r,o,s,u){return a(e,i,s,u),a(t,r,o,u),a(n,e,t,2*u*(1-u)),n}}();t.sqlerp=R;const k=function(){let e=c.a();return function(t,n,i,r){return e[0]=i[0],e[3]=i[1],e[6]=i[2],e[1]=r[0],e[4]=r[1],e[7]=r[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],E(t,s(t,e))}}();t.setAxes=k},function(e,t,n){"use strict";function i(){let e=new r.a(2);return e[0]=0,e[1]=0,e}var r=n(2);!function(){let e=i()}()},function(e,t,n){"use strict";const i=n(39).default;class r{constructor(){this._gui=new i.GUI,this._lightsFolder=this._gui.addFolder("Lights"),this.displayBump=!1,this.displaySpecular=!1,this.bumpIntensity=1,this._specularMap=this._gui.add(this,"displaySpecular"),this._bumpMap=this._gui.add(this,"displayBump"),this._bumpIntensity=this._gui.add(this,"bumpIntensity",0,2)}get lights(){return this._lightsFolder}}t.a=r},function(e,t,n){"use strict";function i(e,t){var n=e.__state.conversionName.toString(),i=Math.round(e.r),r=Math.round(e.g),o=Math.round(e.b),a=e.a,s=Math.round(e.h),u=e.s.toFixed(1),c=e.v.toFixed(1);if(t||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){for(var l=e.hex.toString(16);l.length<6;)l="0"+l;return"#"+l}return"CSS_RGB"===n?"rgb("+i+","+r+","+o+")":"CSS_RGBA"===n?"rgba("+i+","+r+","+o+","+a+")":"HEX"===n?"0x"+e.hex.toString(16):"RGB_ARRAY"===n?"["+i+","+r+","+o+"]":"RGBA_ARRAY"===n?"["+i+","+r+","+o+","+a+"]":"RGB_OBJ"===n?"{r:"+i+",g:"+r+",b:"+o+"}":"RGBA_OBJ"===n?"{r:"+i+",g:"+r+",b:"+o+",a:"+a+"}":"HSV_OBJ"===n?"{h:"+s+",s:"+u+",v:"+c+"}":"HSVA_OBJ"===n?"{h:"+s+",s:"+u+",v:"+c+",a:"+a+"}":"unknown format"}function r(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space?this.__state[t]:(V.recalculateRGB(this,t,n),this.__state[t])},set:function(e){"RGB"!==this.__state.space&&(V.recalculateRGB(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function o(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space?this.__state[t]:(V.recalculateHSV(this),this.__state[t])},set:function(e){"HSV"!==this.__state.space&&(V.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}function a(e){if("0"===e||T.isUndefined(e))return 0;var t=e.match(Y);return T.isNull(t)?0:parseFloat(t[1])}function s(e){var t=e.toString();return t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}function u(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}function c(e,t,n,i,r){return i+(e-t)/(n-t)*(r-i)}function l(e,t,n,i){e.style.background="",T.each(te,function(r){e.style.cssText+="background: "+r+"linear-gradient("+t+", "+n+" 0%, "+i+" 100%); "})}function h(e){e.style.background="",e.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",e.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}function f(e,t,n){var i=document.createElement("li");return t&&i.appendChild(t),n?e.__ul.insertBefore(i,n):e.__ul.appendChild(i),e.onResize(),i}function d(e,t){var n=e.__preset_select[e.__preset_select.selectedIndex];n.innerHTML=t?n.value+"*":n.value}function p(e,t,n){if(n.__li=t,n.__gui=e,T.extend(n,{options:function(t){if(arguments.length>1){var i=n.__li.nextElementSibling;return n.remove(),v(e,n.object,n.property,{before:i,factoryArgs:[T.toArray(arguments)]})}if(T.isArray(t)||T.isObject(t)){var r=n.__li.nextElementSibling;return n.remove(),v(e,n.object,n.property,{before:r,factoryArgs:[t]})}},name:function(e){return n.__li.firstElementChild.firstElementChild.innerHTML=e,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof Z){var i=new Q(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});T.each(["updateDisplay","onChange","onFinishChange","step"],function(e){var t=n[e],r=i[e];n[e]=i[e]=function(){var e=Array.prototype.slice.call(arguments);return r.apply(i,e),t.apply(n,e)}}),X.addClass(t,"has-slider"),n.domElement.insertBefore(i.domElement,n.domElement.firstElementChild)}else if(n instanceof Q){var r=function(t){if(T.isNumber(n.__min)&&T.isNumber(n.__max)){var i=n.__li.firstElementChild.firstElementChild.innerHTML,r=n.__gui.__listening.indexOf(n)>-1;n.remove();var o=v(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]});return o.name(i),r&&o.listen(),o}return t};n.min=T.compose(r,n.min),n.max=T.compose(r,n.max)}else n instanceof G?(X.bind(t,"click",function(){X.fakeEvent(n.__checkbox,"click")}),X.bind(n.__checkbox,"click",function(e){e.stopPropagation()})):n instanceof $?(X.bind(t,"click",function(){X.fakeEvent(n.__button,"click")}),X.bind(t,"mouseover",function(){X.addClass(n.__button,"hover")}),X.bind(t,"mouseout",function(){X.removeClass(n.__button,"hover")})):n instanceof ee&&(X.addClass(t,"color"),n.updateDisplay=T.compose(function(e){return t.style.borderLeftColor=n.__color.toString(),e},n.updateDisplay),n.updateDisplay());n.setValue=T.compose(function(t){return e.getRoot().__preset_select&&n.isModified()&&d(e.getRoot(),!0),t},n.setValue)}function m(e,t){var n=e.getRoot(),i=n.__rememberedObjects.indexOf(t.object);if(-1!==i){var r=n.__rememberedObjectIndecesToControllers[i];if(void 0===r&&(r={},n.__rememberedObjectIndecesToControllers[i]=r),r[t.property]=t,n.load&&n.load.remembered){var o=n.load.remembered,a=void 0;if(o[e.preset])a=o[e.preset];else{if(!o[se])return;a=o[se]}if(a[i]&&void 0!==a[i][t.property]){var s=a[i][t.property];t.initialValue=s,t.setValue(s)}}}}function v(e,t,n,i){if(void 0===t[n])throw new Error('Object "'+t+'" has no property "'+n+'"');var r=void 0;if(i.color)r=new ee(t,n);else{var o=[t,n].concat(i.factoryArgs);r=ie.apply(e,o)}i.before instanceof z&&(i.before=i.before.__li),m(e,r),X.addClass(r.domElement,"c");var a=document.createElement("span");X.addClass(a,"property-name"),a.innerHTML=r.property;var s=document.createElement("div");s.appendChild(a),s.appendChild(r.domElement);var u=f(e,s,i.before);return X.addClass(u,pe.CLASS_CONTROLLER_ROW),r instanceof ee?X.addClass(u,"color"):X.addClass(u,P(r.getValue())),p(e,u,r),e.__controllers.push(r),r}function g(e,t){return document.location.href+"."+t}function b(e,t,n){var i=document.createElement("option");i.innerHTML=t,i.value=t,e.__preset_select.appendChild(i),n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function _(e,t){t.style.display=e.useLocalStorage?"block":"none"}function y(e){var t=e.__save_row=document.createElement("li");X.addClass(e.domElement,"has-save"),e.__ul.insertBefore(t,e.__ul.firstChild),X.addClass(t,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",X.addClass(n,"button gears");var i=document.createElement("span");i.innerHTML="Save",X.addClass(i,"button"),X.addClass(i,"save");var r=document.createElement("span");r.innerHTML="New",X.addClass(r,"button"),X.addClass(r,"save-as");var o=document.createElement("span");o.innerHTML="Revert",X.addClass(o,"button"),X.addClass(o,"revert");var a=e.__preset_select=document.createElement("select");if(e.load&&e.load.remembered?T.each(e.load.remembered,function(t,n){b(e,n,n===e.preset)}):b(e,se,!1),X.bind(a,"change",function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value}),t.appendChild(a),t.appendChild(n),t.appendChild(i),t.appendChild(r),t.appendChild(o),ue){var s=document.getElementById("dg-local-explain"),u=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(g(e,"isLocal"))&&u.setAttribute("checked","checked"),_(e,s),X.bind(u,"change",function(){e.useLocalStorage=!e.useLocalStorage,_(e,s)})}var c=document.getElementById("dg-new-constructor");X.bind(c,"keydown",function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||ce.hide()}),X.bind(n,"click",function(){c.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),ce.show(),c.focus(),c.select()}),X.bind(i,"click",function(){e.save()}),X.bind(r,"click",function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)}),X.bind(o,"click",function(){e.revert()})}function w(e){function t(t){return t.preventDefault(),e.width+=r-t.clientX,e.onResize(),r=t.clientX,!1}function n(){X.removeClass(e.__closeButton,pe.CLASS_DRAG),X.unbind(window,"mousemove",t),X.unbind(window,"mouseup",n)}function i(i){return i.preventDefault(),r=i.clientX,X.addClass(e.__closeButton,pe.CLASS_DRAG),X.bind(window,"mousemove",t),X.bind(window,"mouseup",n),!1}var r=void 0;e.__resize_handle=document.createElement("div"),T.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),X.bind(e.__resize_handle,"mousedown",i),X.bind(e.__closeButton,"mousedown",i),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function M(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function x(e,t){var n={};return T.each(e.__rememberedObjects,function(i,r){var o={},a=e.__rememberedObjectIndecesToControllers[r];T.each(a,function(e,n){o[n]=t?e.initialValue:e.getValue()}),n[r]=o}),n}function S(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}function E(e){0!==e.length&&re.call(window,function(){E(e)}),T.each(e,function(e){e.updateDisplay()})}Object.defineProperty(t,"__esModule",{value:!0});var A=Array.prototype.forEach,L=Array.prototype.slice,T={BREAK:{},extend:function(e){return this.each(L.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(n){this.isUndefined(t[n])||(e[n]=t[n])}.bind(this))},this),e},defaults:function(e){return this.each(L.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(n){this.isUndefined(e[n])&&(e[n]=t[n])}.bind(this))},this),e},compose:function(){var e=L.call(arguments);return function(){for(var t=L.call(arguments),n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},each:function(e,t,n){if(e)if(A&&e.forEach&&e.forEach===A)e.forEach(t,n);else if(e.length===e.length+0){var i=void 0,r=void 0;for(i=0,r=e.length;i<r;i++)if(i in e&&t.call(n,e[i],i)===this.BREAK)return}else for(var o in e)if(t.call(n,e[o],o)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(e,t,n){var i=void 0;return function(){var r=this,o=arguments,a=n||!i;clearTimeout(i),i=setTimeout(function(){i=null,n||e.apply(r,o)},t),a&&e.apply(r,o)}},toArray:function(e){return e.toArray?e.toArray():L.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return isNaN(e)}),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}},R=[{litmus:T.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:i},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:i},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:i},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:i}}},{litmus:T.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:T.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:T.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(T.isNumber(e.r)&&T.isNumber(e.g)&&T.isNumber(e.b)&&T.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(T.isNumber(e.r)&&T.isNumber(e.g)&&T.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(T.isNumber(e.h)&&T.isNumber(e.s)&&T.isNumber(e.v)&&T.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(T.isNumber(e.h)&&T.isNumber(e.s)&&T.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],k=void 0,C=void 0,I=function(){C=!1;var e=arguments.length>1?T.toArray(arguments):arguments[0];return T.each(R,function(t){if(t.litmus(e))return T.each(t.conversions,function(t,n){if(k=t.read(e),!1===C&&!1!==k)return C=k,k.conversionName=n,k.conversion=t,T.BREAK}),T.BREAK}),C},O=void 0,B={hsv_to_rgb:function(e,t,n){var i=Math.floor(e/60)%6,r=e/60-Math.floor(e/60),o=n*(1-t),a=n*(1-r*t),s=n*(1-(1-r)*t),u=[[n,s,o],[a,n,o],[o,n,s],[o,a,n],[s,o,n],[n,o,a]][i];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(e,t,n){var i=Math.min(e,t,n),r=Math.max(e,t,n),o=r-i,a=void 0,s=void 0;return 0===r?{h:NaN,s:0,v:0}:(s=o/r,a=e===r?(t-n)/o:t===r?2+(n-e)/o:4+(e-t)/o,(a/=6)<0&&(a+=1),{h:360*a,s:s,v:r/255})},rgb_to_hex:function(e,t,n){var i=this.hex_with_component(0,2,e);return i=this.hex_with_component(i,1,t),i=this.hex_with_component(i,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,n){return n<<(O=8*t)|e&~(255<<O)}},P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},D=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),U=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},F=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},j=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},V=function(){function e(){if(N(this,e),this.__state=I.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return D(e,[{key:"toString",value:function(){return i(this)}},{key:"toHexString",value:function(){return i(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),e}();V.recalculateRGB=function(e,t,n){if("HEX"===e.__state.space)e.__state[t]=B.component_from_hex(e.__state.hex,n);else{if("HSV"!==e.__state.space)throw new Error("Corrupted color state");T.extend(e.__state,B.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}},V.recalculateHSV=function(e){var t=B.rgb_to_hsv(e.r,e.g,e.b);T.extend(e.__state,{s:t.s,v:t.v}),T.isNaN(t.h)?T.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h},V.COMPONENTS=["r","g","b","h","s","v","hex","a"],r(V.prototype,"r",2),r(V.prototype,"g",1),r(V.prototype,"b",0),o(V.prototype,"h"),o(V.prototype,"s"),o(V.prototype,"v"),Object.defineProperty(V.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(V.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=B.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var z=function(){function e(t,n){N(this,e),this.initialValue=t[n],this.domElement=document.createElement("div"),this.object=t,this.property=n,this.__onChange=void 0,this.__onFinishChange=void 0}return D(e,[{key:"onChange",value:function(e){return this.__onChange=e,this}},{key:"onFinishChange",value:function(e){return this.__onFinishChange=e,this}},{key:"setValue",value:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),e}(),H={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},q={};T.each(H,function(e,t){T.each(e,function(e){q[e]=t})});var Y=/(\d+(\.\d+)?)px/,X={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,n){var i=n,r=t;T.isUndefined(r)&&(r=!0),T.isUndefined(i)&&(i=!0),e.style.position="absolute",r&&(e.style.left=0,e.style.right=0),i&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,n,i){var r=n||{},o=q[t];if(!o)throw new Error("Event type "+t+" not supported.");var a=document.createEvent(o);switch(o){case"MouseEvents":var s=r.x||r.clientX||0,u=r.y||r.clientY||0;a.initMouseEvent(t,r.bubbles||!1,r.cancelable||!0,window,r.clickCount||1,0,0,s,u,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var c=a.initKeyboardEvent||a.initKeyEvent;T.defaults(r,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(t,r.bubbles||!1,r.cancelable,window,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.keyCode,r.charCode);break;default:a.initEvent(t,r.bubbles||!1,r.cancelable||!0)}T.defaults(a,i),e.dispatchEvent(a)},bind:function(e,t,n,i){var r=i||!1;return e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent("on"+t,n),X},unbind:function(e,t,n,i){var r=i||!1;return e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent&&e.detachEvent("on"+t,n),X},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var n=e.className.split(/ +/);-1===n.indexOf(t)&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return X},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var n=e.className.split(/ +/),i=n.indexOf(t);-1!==i&&(n.splice(i,1),e.className=n.join(" "))}else e.className=void 0;return X},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return a(t["border-left-width"])+a(t["border-right-width"])+a(t["padding-left"])+a(t["padding-right"])+a(t.width)},getHeight:function(e){var t=getComputedStyle(e);return a(t["border-top-width"])+a(t["border-bottom-width"])+a(t["padding-top"])+a(t["padding-bottom"])+a(t.height)},getOffset:function(e){var t=e,n={left:0,top:0};if(t.offsetParent)do{n.left+=t.offsetLeft,n.top+=t.offsetTop,t=t.offsetParent}while(t);return n},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},G=function(e){function t(e,n){N(this,t);var i=j(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),r=i;return i.__prev=i.getValue(),i.__checkbox=document.createElement("input"),i.__checkbox.setAttribute("type","checkbox"),X.bind(i.__checkbox,"change",function(){r.setValue(!r.__prev)},!1),i.domElement.appendChild(i.__checkbox),i.updateDisplay(),i}return F(t,z),D(t,[{key:"setValue",value:function(e){var n=U(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),U(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(),W=function(e){function t(e,n,i){N(this,t);var r=j(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),o=i,a=r;if(r.__select=document.createElement("select"),T.isArray(o)){var s={};T.each(o,function(e){s[e]=e}),o=s}return T.each(o,function(e,t){var n=document.createElement("option");n.innerHTML=t,n.setAttribute("value",e),a.__select.appendChild(n)}),r.updateDisplay(),X.bind(r.__select,"change",function(){var e=this.options[this.selectedIndex].value;a.setValue(e)}),r.domElement.appendChild(r.__select),r}return F(t,z),D(t,[{key:"setValue",value:function(e){var n=U(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n}},{key:"updateDisplay",value:function(){return X.isActive(this.__select)?this:(this.__select.value=this.getValue(),U(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this))}}]),t}(),K=function(e){function t(e,n){function i(){o.setValue(o.__input.value)}N(this,t);var r=j(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),o=r;return r.__input=document.createElement("input"),r.__input.setAttribute("type","text"),X.bind(r.__input,"keyup",i),X.bind(r.__input,"change",i),X.bind(r.__input,"blur",function(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}),X.bind(r.__input,"keydown",function(e){13===e.keyCode&&this.blur()}),r.updateDisplay(),r.domElement.appendChild(r.__input),r}return F(t,z),D(t,[{key:"updateDisplay",value:function(){return X.isActive(this.__input)||(this.__input.value=this.getValue()),U(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(),J=function(e){function t(e,n,i){N(this,t);var r=j(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),o=i||{};return r.__min=o.min,r.__max=o.max,r.__step=o.step,T.isUndefined(r.__step)?0===r.initialValue?r.__impliedStep=1:r.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(r.initialValue))/Math.LN10))/10:r.__impliedStep=r.__step,r.__precision=s(r.__impliedStep),r}return F(t,z),D(t,[{key:"setValue",value:function(e){var n=e;return void 0!==this.__min&&n<this.__min?n=this.__min:void 0!==this.__max&&n>this.__max&&(n=this.__max),void 0!==this.__step&&n%this.__step!=0&&(n=Math.round(n/this.__step)*this.__step),U(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,n)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=s(e),this}}]),t}(),Q=function(e){function t(e,n,i){function r(){u.__onFinishChange&&u.__onFinishChange.call(u,u.getValue())}function o(e){var t=c-e.clientY;u.setValue(u.getValue()+t*u.__impliedStep),c=e.clientY}function a(){X.unbind(window,"mousemove",o),X.unbind(window,"mouseup",a),r()}N(this,t);var s=j(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i));s.__truncationSuspended=!1;var u=s,c=void 0;return s.__input=document.createElement("input"),s.__input.setAttribute("type","text"),X.bind(s.__input,"change",function(){var e=parseFloat(u.__input.value);T.isNaN(e)||u.setValue(e)}),X.bind(s.__input,"blur",function(){r()}),X.bind(s.__input,"mousedown",function(e){X.bind(window,"mousemove",o),X.bind(window,"mouseup",a),c=e.clientY}),X.bind(s.__input,"keydown",function(e){13===e.keyCode&&(u.__truncationSuspended=!0,this.blur(),u.__truncationSuspended=!1,r())}),s.updateDisplay(),s.domElement.appendChild(s.__input),s}return F(t,J),D(t,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():u(this.getValue(),this.__precision),U(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(),Z=function(e){function t(e,n,i,r,o){function a(e){e.preventDefault();var t=f.__background.getBoundingClientRect();return f.setValue(c(e.clientX,t.left,t.right,f.__min,f.__max)),!1}function s(){X.unbind(window,"mousemove",a),X.unbind(window,"mouseup",s),f.__onFinishChange&&f.__onFinishChange.call(f,f.getValue())}function u(e){var t=e.touches[0].clientX,n=f.__background.getBoundingClientRect();f.setValue(c(t,n.left,n.right,f.__min,f.__max))}function l(){X.unbind(window,"touchmove",u),X.unbind(window,"touchend",l),f.__onFinishChange&&f.__onFinishChange.call(f,f.getValue())}N(this,t);var h=j(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,{min:i,max:r,step:o})),f=h;return h.__background=document.createElement("div"),h.__foreground=document.createElement("div"),X.bind(h.__background,"mousedown",function(e){document.activeElement.blur(),X.bind(window,"mousemove",a),X.bind(window,"mouseup",s),a(e)}),X.bind(h.__background,"touchstart",function(e){1===e.touches.length&&(X.bind(window,"touchmove",u),X.bind(window,"touchend",l),u(e))}),X.addClass(h.__background,"slider"),X.addClass(h.__foreground,"slider-fg"),h.updateDisplay(),h.__background.appendChild(h.__foreground),h.domElement.appendChild(h.__background),h}return F(t,J),D(t,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",U(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(),$=function(e){function t(e,n,i){N(this,t);var r=j(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),o=r;return r.__button=document.createElement("div"),r.__button.innerHTML=void 0===i?"Fire":i,X.bind(r.__button,"click",function(e){return e.preventDefault(),o.fire(),!1}),X.addClass(r.__button,"button"),r.domElement.appendChild(r.__button),r}return F(t,z),D(t,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),t}(),ee=function(e){function t(e,n){function i(e){c(e),X.bind(window,"mousemove",c),X.bind(window,"touchmove",c),X.bind(window,"mouseup",o),X.bind(window,"touchend",o)}function r(e){f(e),X.bind(window,"mousemove",f),X.bind(window,"touchmove",f),X.bind(window,"mouseup",a),X.bind(window,"touchend",a)}function o(){X.unbind(window,"mousemove",c),X.unbind(window,"touchmove",c),X.unbind(window,"mouseup",o),X.unbind(window,"touchend",o),u()}function a(){X.unbind(window,"mousemove",f),X.unbind(window,"touchmove",f),X.unbind(window,"mouseup",a),X.unbind(window,"touchend",a),u()}function s(){var e=I(this.value);!1!==e?(p.__color.__state=e,p.setValue(p.__color.toOriginal())):this.value=p.__color.toString()}function u(){p.__onFinishChange&&p.__onFinishChange.call(p,p.__color.toOriginal())}function c(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=p.__saturation_field.getBoundingClientRect(),n=e.touches&&e.touches[0]||e,i=n.clientX,r=n.clientY,o=(i-t.left)/(t.right-t.left),a=1-(r-t.top)/(t.bottom-t.top);return a>1?a=1:a<0&&(a=0),o>1?o=1:o<0&&(o=0),p.__color.v=a,p.__color.s=o,p.setValue(p.__color.toOriginal()),!1}function f(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=p.__hue_field.getBoundingClientRect(),n=1-((e.touches&&e.touches[0]||e).clientY-t.top)/(t.bottom-t.top);return n>1?n=1:n<0&&(n=0),p.__color.h=360*n,p.setValue(p.__color.toOriginal()),!1}N(this,t);var d=j(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));d.__color=new V(d.getValue()),d.__temp=new V(0);var p=d;d.domElement=document.createElement("div"),X.makeSelectable(d.domElement,!1),d.__selector=document.createElement("div"),d.__selector.className="selector",d.__saturation_field=document.createElement("div"),d.__saturation_field.className="saturation-field",d.__field_knob=document.createElement("div"),d.__field_knob.className="field-knob",d.__field_knob_border="2px solid ",d.__hue_knob=document.createElement("div"),d.__hue_knob.className="hue-knob",d.__hue_field=document.createElement("div"),d.__hue_field.className="hue-field",d.__input=document.createElement("input"),d.__input.type="text",d.__input_textShadow="0 1px 1px ",X.bind(d.__input,"keydown",function(e){13===e.keyCode&&s.call(this)}),X.bind(d.__input,"blur",s),X.bind(d.__selector,"mousedown",function(){X.addClass(this,"drag").bind(window,"mouseup",function(){X.removeClass(p.__selector,"drag")})}),X.bind(d.__selector,"touchstart",function(){X.addClass(this,"drag").bind(window,"touchend",function(){X.removeClass(p.__selector,"drag")})});var m=document.createElement("div");return T.extend(d.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),T.extend(d.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:d.__field_knob_border+(d.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),T.extend(d.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),T.extend(d.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),T.extend(m.style,{width:"100%",height:"100%",background:"none"}),l(m,"top","rgba(0,0,0,0)","#000"),T.extend(d.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),h(d.__hue_field),T.extend(d.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:d.__input_textShadow+"rgba(0,0,0,0.7)"}),X.bind(d.__saturation_field,"mousedown",i),X.bind(d.__saturation_field,"touchstart",i),X.bind(d.__field_knob,"mousedown",i),X.bind(d.__field_knob,"touchstart",i),X.bind(d.__hue_field,"mousedown",r),X.bind(d.__hue_field,"touchstart",r),d.__saturation_field.appendChild(m),d.__selector.appendChild(d.__field_knob),d.__selector.appendChild(d.__saturation_field),d.__selector.appendChild(d.__hue_field),d.__hue_field.appendChild(d.__hue_knob),d.domElement.appendChild(d.__input),d.domElement.appendChild(d.__selector),d.updateDisplay(),d}return F(t,z),D(t,[{key:"updateDisplay",value:function(){var e=I(this.getValue());if(!1!==e){var t=!1;T.each(V.COMPONENTS,function(n){if(!T.isUndefined(e[n])&&!T.isUndefined(this.__color.__state[n])&&e[n]!==this.__color.__state[n])return t=!0,{}},this),t&&T.extend(this.__color.__state,e)}T.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var n=this.__color.v<.5||this.__color.s>.5?255:0,i=255-n;T.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+n+","+n+","+n+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,l(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),T.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+n+","+n+","+n+")",textShadow:this.__input_textShadow+"rgba("+i+","+i+","+i+",.7)"})}}]),t}(),te=["-moz-","-o-","-webkit-","-ms-",""],ne={load:function(e,t){var n=t||document,i=n.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=e,n.getElementsByTagName("head")[0].appendChild(i)},inject:function(e,t){var n=t||document,i=document.createElement("style");i.type="text/css",i.innerHTML=e;var r=n.getElementsByTagName("head")[0];try{r.appendChild(i)}catch(e){}}},ie=function(e,t){var n=e[t];return T.isArray(arguments[2])||T.isObject(arguments[2])?new W(e,t,arguments[2]):T.isNumber(n)?T.isNumber(arguments[2])&&T.isNumber(arguments[3])?T.isNumber(arguments[4])?new Z(e,t,arguments[2],arguments[3],arguments[4]):new Z(e,t,arguments[2],arguments[3]):T.isNumber(arguments[4])?new Q(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new Q(e,t,{min:arguments[2],max:arguments[3]}):T.isString(n)?new K(e,t):T.isFunction(n)?new $(e,t,""):T.isBoolean(n)?new G(e,t):null},re=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},oe=function(){function e(){N(this,e),this.backgroundElement=document.createElement("div"),T.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),X.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),T.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var t=this;X.bind(this.backgroundElement,"click",function(){t.hide()})}return D(e,[{key:"show",value:function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),T.defer(function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var e=this,t=function t(){e.domElement.style.display="none",e.backgroundElement.style.display="none",X.unbind(e.domElement,"webkitTransitionEnd",t),X.unbind(e.domElement,"transitionend",t),X.unbind(e.domElement,"oTransitionEnd",t)};X.bind(this.domElement,"webkitTransitionEnd",t),X.bind(this.domElement,"transitionend",t),X.bind(this.domElement,"oTransitionEnd",t),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-X.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-X.getHeight(this.domElement)/2+"px"}}]),e}(),ae=function(e){if(e&&"undefined"!=typeof window){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=e,document.head.appendChild(t),e}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid transparent}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n");ne.inject(ae);var se="Default",ue=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}}(),ce=void 0,le=!0,he=void 0,fe=!1,de=[],pe=function e(t){var n=this,i=t||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),X.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],i=T.defaults(i,{closeOnTop:!1,autoPlace:!0,width:e.DEFAULT_WIDTH}),i=T.defaults(i,{resizable:i.autoPlace,hideable:i.autoPlace}),T.isUndefined(i.load)?i.load={preset:se}:i.preset&&(i.load.preset=i.preset),T.isUndefined(i.parent)&&i.hideable&&de.push(this),i.resizable=T.isUndefined(i.parent)&&i.resizable,i.autoPlace&&T.isUndefined(i.scrollable)&&(i.scrollable=!0);var r=ue&&"true"===localStorage.getItem(g(this,"isLocal")),o=void 0;if(Object.defineProperties(this,{parent:{get:function(){return i.parent}},scrollable:{get:function(){return i.scrollable}},autoPlace:{get:function(){return i.autoPlace}},closeOnTop:{get:function(){return i.closeOnTop}},preset:{get:function(){return n.parent?n.getRoot().preset:i.load.preset},set:function(e){n.parent?n.getRoot().preset=e:i.load.preset=e,S(this),n.revert()}},width:{get:function(){return i.width},set:function(e){i.width=e,M(n,e)}},name:{get:function(){return i.name},set:function(e){i.name=e,titleRowName&&(titleRowName.innerHTML=i.name)}},closed:{get:function(){return i.closed},set:function(t){i.closed=t,i.closed?X.addClass(n.__ul,e.CLASS_CLOSED):X.removeClass(n.__ul,e.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=t?e.TEXT_OPEN:e.TEXT_CLOSED)}},load:{get:function(){return i.load}},useLocalStorage:{get:function(){return r},set:function(e){ue&&(r=e,e?X.bind(window,"unload",o):X.unbind(window,"unload",o),localStorage.setItem(g(n,"isLocal"),e))}}}),T.isUndefined(i.parent)){if(i.closed=!1,X.addClass(this.domElement,e.CLASS_MAIN),X.makeSelectable(this.domElement,!1),ue&&r){n.useLocalStorage=!0;var a=localStorage.getItem(g(this,"gui"));a&&(i.load=JSON.parse(a))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=e.TEXT_CLOSED,X.addClass(this.__closeButton,e.CLASS_CLOSE_BUTTON),i.closeOnTop?(X.addClass(this.__closeButton,e.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(X.addClass(this.__closeButton,e.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),X.bind(this.__closeButton,"click",function(){n.closed=!n.closed})}else{void 0===i.closed&&(i.closed=!0);var s=document.createTextNode(i.name);X.addClass(s,"controller-name");var u=f(n,s),c=function(e){return e.preventDefault(),n.closed=!n.closed,!1};X.addClass(this.__ul,e.CLASS_CLOSED),X.addClass(u,"title"),X.bind(u,"click",c),i.closed||(this.closed=!1)}i.autoPlace&&(T.isUndefined(i.parent)&&(le&&(he=document.createElement("div"),X.addClass(he,"dg"),X.addClass(he,e.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(he),le=!1),he.appendChild(this.domElement),X.addClass(this.domElement,e.CLASS_AUTO_PLACE)),this.parent||M(n,i.width)),this.__resizeHandler=function(){n.onResizeDebounced()},X.bind(window,"resize",this.__resizeHandler),X.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),X.bind(this.__ul,"transitionend",this.__resizeHandler),X.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),i.resizable&&w(this),o=function(){ue&&"true"===localStorage.getItem(g(n,"isLocal"))&&localStorage.setItem(g(n,"gui"),JSON.stringify(n.getSaveObject()))},this.saveToLocalStorageIfPossible=o,i.parent||function(){var e=n.getRoot();e.width+=1,T.defer(function(){e.width-=1})}()};pe.toggleHide=function(){fe=!fe,T.each(de,function(e){e.domElement.style.display=fe?"none":""})},pe.CLASS_AUTO_PLACE="a",pe.CLASS_AUTO_PLACE_CONTAINER="ac",pe.CLASS_MAIN="main",pe.CLASS_CONTROLLER_ROW="cr",pe.CLASS_TOO_TALL="taller-than-window",pe.CLASS_CLOSED="closed",pe.CLASS_CLOSE_BUTTON="close-button",pe.CLASS_CLOSE_TOP="close-top",pe.CLASS_CLOSE_BOTTOM="close-bottom",pe.CLASS_DRAG="drag",pe.DEFAULT_WIDTH=245,pe.TEXT_CLOSED="Close Controls",pe.TEXT_OPEN="Open Controls",pe._keydownHandler=function(e){"text"===document.activeElement.type||72!==e.which&&72!==e.keyCode||pe.toggleHide()},X.bind(window,"keydown",pe._keydownHandler,!1),T.extend(pe.prototype,{add:function(e,t){return v(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return v(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;T.defer(function(){t.onResize()})},destroy:function(){this.autoPlace&&he.removeChild(this.domElement),X.unbind(window,"keydown",pe._keydownHandler,!1),X.unbind(window,"resize",this.__resizeHandler),this.saveToLocalStorageIfPossible&&X.unbind(window,"unload",this.saveToLocalStorageIfPossible)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var n=new pe(t);this.__folders[e]=n;var i=f(this,n.domElement);return X.addClass(i,"folder"),n},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name];var t=this;T.defer(function(){t.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=X.getOffset(e.__ul).top,n=0;T.each(e.__ul.childNodes,function(t){e.autoPlace&&t===e.__save_row||(n+=X.getHeight(t))}),window.innerHeight-t-20<n?(X.addClass(e.domElement,pe.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-20+"px"):(X.removeClass(e.domElement,pe.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&T.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:T.debounce(function(){this.onResize()},50),remember:function(){if(T.isUndefined(ce)&&((ce=new oe).domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;T.each(Array.prototype.slice.call(arguments),function(t){0===e.__rememberedObjects.length&&y(e),-1===e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)}),this.autoPlace&&M(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=x(this)),e.folders={},T.each(this.__folders,function(t,n){e.folders[n]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=x(this),d(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[se]=x(this,!0)),this.load.remembered[e]=x(this),this.preset=e,b(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){T.each(this.__controllers,function(t){this.getRoot().load.remembered?m(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),T.each(this.__folders,function(e){e.revert(e)}),e||d(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&E(this.__listening)},updateDisplay:function(){T.each(this.__controllers,function(e){e.updateDisplay()}),T.each(this.__folders,function(e){e.updateDisplay()})}});var me={color:{Color:V,math:B,interpret:I},controllers:{Controller:z,BooleanController:G,OptionController:W,StringController:K,NumberController:J,NumberControllerBox:Q,NumberControllerSlider:Z,FunctionController:$,ColorController:ee},dom:{dom:X},gui:{GUI:pe},GUI:pe};t.default=me},function(e,t,n){"use strict";var i=n(1),r=(n(0),n(5));class o{constructor(){`#version 300 es\n            precision mediump float;\n\n            uniform mat4 mvp;\n            in vec3 position;            \n\n            void main() {\n                gl_Position = mvp * vec4(position, 1.0);\n            }\n            `,`#version 300 es\n        precision mediump float;\n\n        out vec4 outColor;\n\n        void main() {\n            outColor = vec4(1.0, 0.0, 0.0, 1.0);\n        }\n        `;const e=Object(i.b)();this.program=Object(r.a)(e,"#version 300 es\n            precision mediump float;\n\n            uniform mat4 mvp;\n            in vec3 position;            \n\n            void main() {\n                gl_Position = mvp * vec4(position, 1.0);\n            }\n            ","#version 300 es\n        precision mediump float;\n\n        out vec4 outColor;\n\n        void main() {\n            outColor = vec4(1.0, 0.0, 0.0, 1.0);\n        }\n        "),this.programInfo={attribLocations:{position:e.getAttribLocation(this.program,"position")},uniformLocations:{mvp:e.getUniformLocation(this.program,"mvp")}}}activate(){Object(i.b)().useProgram(this.program)}}t.a=o},function(e,t,n){"use strict";var i=n(1);class r{constructor(e){const t=Object(i.b)();this.location=++r.location,this.data=new Float32Array(e),this.buffer=t.createBuffer(),t.bindBuffer(t.UNIFORM_BUFFER,this.buffer),t.bufferData(t.UNIFORM_BUFFER,this.data,t.STATIC_DRAW),t.bindBuffer(t.UNIFORM_BUFFER,null)}bind(){const e=Object(i.b)();e.bindBufferBase(e.UNIFORM_BUFFER,this.location,this.buffer)}update(e,t=0){const n=Object(i.b)();this.data.set(e,t),n.bindBuffer(n.UNIFORM_BUFFER,this.buffer),n.bufferSubData(n.UNIFORM_BUFFER,0,this.data,0,null),n.bindBuffer(n.UNIFORM_BUFFER,null)}}r.location=0,t.a=r},function(e,t,n){"use strict";class i{constructor(e,t,n){const i=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1];for(let r=0;r<i.length;r+=3)i[r+0]*=e,i[r+1]*=t,i[r+2]*=n;return{positions:i,indices:[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],normals:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0],uvs:[0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]}}}t.a=i},function(e,t,n){"use strict";var i=n(1),r=n(11),o=(n(44),n(45),n(46)),a=n(0);class s extends r.a{constructor(e){super(),this._normalMatrix=a.a.create(),this._geometry=e,this._indexCounts=[],this._shaders=[];for(let t=0;t<e.indicesByMaterial.length;++t)this._indexCounts.push(e.indicesByMaterial[t].length);this._buffers=this._initializeBuffers()}get normalMatrix(){return this._normalMatrix}get shaders(){return this._shaders}get indexCount(){return this._indexCount}get buffers(){return this._buffers}set normalMatrix(e){this._normalMatrix=e}attachShader(e){Object.entries(e.materialIndices).forEach(([t,n])=>{const i=e.materialsByIndex[n];this._shaders.push(new o.a(i))})}_initializeBuffers(){const e=this._geometry,t=Object(i.b)(),n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e.positions),t.STATIC_DRAW);const r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e.normals),t.STATIC_DRAW);const o=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e.tangents),t.STATIC_DRAW);const a=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,a),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e.bitangents),t.STATIC_DRAW);let s=[];for(let n=0;n<e.indicesByMaterial.length;++n){const i=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint32Array(e.indicesByMaterial[n]),t.STATIC_DRAW),s.push(i)}let u;return e.uvs&&(u=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,u),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e.uvs),t.STATIC_DRAW)),{positions:n,indices:s,normals:r,uvs:u,tangents:o,bitangents:a}}draw(e){const t=Object(i.b)(),n=this._shaders[e].programInfo;t.bindBuffer(t.ARRAY_BUFFER,this._buffers.uvs),t.enableVertexAttribArray(n.attribLocations.uv),t.vertexAttribPointer(n.attribLocations.uv,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this._buffers.normals),t.enableVertexAttribArray(n.attribLocations.normal),t.vertexAttribPointer(n.attribLocations.normal,3,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this._buffers.positions),t.enableVertexAttribArray(n.attribLocations.position),t.vertexAttribPointer(n.attribLocations.position,3,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this._buffers.tangents),t.enableVertexAttribArray(n.attribLocations.tangent),t.vertexAttribPointer(n.attribLocations.tangent,3,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this._buffers.bitangents),t.enableVertexAttribArray(n.attribLocations.bitangent),t.vertexAttribPointer(n.attribLocations.bitangent,3,t.FLOAT,!1,0,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._buffers.indices[e]),t.drawElements(t.TRIANGLES,this._indexCounts[e],t.UNSIGNED_INT,0)}}t.a=s},function(e,t,n){"use strict";n(1),n(0),n(5),n(9)},function(e,t,n){"use strict";n(1),n(0),n(5),n(9)},function(e,t,n){"use strict";var i=n(1),r=(n(0),n(5)),o=n(9);class a{constructor(e){this._materialData=e,e.mapSpecular&&(this._specularMap=new o.a,this._specularMap.createTexture(e.mapSpecular.texture)),e.mapDiffuse&&(this._texture=new o.a,this._texture.createTexture(e.mapDiffuse.texture)),e.mapBump&&(this._bumpMap=new o.a,this._bumpMap.createTexture(e.mapBump.texture));`#version 300 es\n            precision mediump int;\n            precision mediump float;\n\n            layout (std140) uniform modelMatrices {\n                mat4 modelMatrix;\n                mat4 normalMatrix;\n            };\n    \n            layout (std140) uniform sceneMatrices {\n                mat4 viewMatrix;\n                mat4 projectionMatrix;\n            };\n\n            in vec3 position;\n            in vec3 normal;\n            in vec2 uv;\n\n            in vec3 tangent;\n            in vec3 bitangent;\n            \n            out vec3 vPosViewSpace;\n            out vec2 vUv;\n\n            out vec3 vNormalViewSpace;\n            out vec3 vTangentViewSpace;\n            out vec3 vBitangentViewSpace;\n\n            out mat3 TBN;\n\n            void main() {\n                mat4 modelViewMatrix = viewMatrix * modelMatrix;\n                                \n                vNormalViewSpace = vec3(mat3(modelViewMatrix) * normalize(normal));\n                vTangentViewSpace = vec3(mat3(modelViewMatrix) * normalize(tangent));\n                vBitangentViewSpace = vec3(mat3(modelViewMatrix) * normalize(bitangent));\n            \n                // Transpose is ok since we don't do non-uniform scaling\n                TBN = transpose(mat3(\n                    vTangentViewSpace,\n                    vBitangentViewSpace,\n                    vNormalViewSpace\n                ));\n                \n                vPosViewSpace = vec3(modelViewMatrix * vec4(position, 1.0));\n                vUv = uv;\n                gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n            }\n        `,`#version 300 es\n            precision mediump float;\n            precision mediump int;\n\n            const int MAX_DIRECTIONAL_LIGHTS = 16;\n\n            layout (std140) uniform sceneMatrices {\n                mat4 viewMatrix;\n                mat4 projectionMatrix;\n            };\n\n            layout (std140) uniform modelMatrices {\n                mat4 modelMatrix;\n                mat4 normalMatrix;\n            };\n\n            struct Directional {\n                vec3 positionViewSpace;\n                vec4 color;\n                float intensity;\n            };\n\n            layout (std140) uniform materialBuffer {\n                vec4 mambient; // 16 0 \n                vec4 mdiffuse; // 16 16\n                //vec4 memissive; // 16 32\n                vec4 mspecular; // 16 32\n                float specularExponent; // 4 48\n                float bumpIntensity; // 4 52\n                bool hasDiffuseMap; // 4 56\n                bool hasNormalMap; // 4 60\n                bool hasSpecularMap; // 4 64\n                bool displayNormalMap; // 4 68\n                bool displaySpecularMap;\n            };\n\n            layout (std140) uniform directionalBuffer {\n                Directional directionalLights[MAX_DIRECTIONAL_LIGHTS];\n            };\n\n            uniform int numLights;\n\n            // Textures\n            uniform sampler2D textureMap;\n            uniform sampler2D bumpMap;\n            uniform sampler2D specularMap;\n\n            in vec3 vPosViewSpace;\n            in vec3 vNormalViewSpace;\n\n            in vec3 vTangentViewSpace;\n            in vec3 vBitangentViewSpace;\n\n            in mat3 TBN;\n            in vec2 vUv;\n\n            // TODO: light uniforms\n            vec3 Ia = vec3(0.2);\n            vec3 Id = vec3(1.0);\n            vec3 Is = vec3(1.0);\n\n            out vec4 outColor;\n\n            void light(int lightIndex, vec3 vPos, vec3 norm, out vec3 ambient, out vec3 diffuse, out vec3 spec) {\n\n                // View space\n                vec3 n = norm;\n                vec3 s = directionalLights[lightIndex].positionViewSpace - vPos;\n                vec3 v = -vPos;\n\n                if (hasNormalMap) {\n                    // Convert from view to tangent space\n                    s = normalize(TBN * s);\n                    v = normalize(TBN * v);\n                    //n = normalize(n);\n\n                    vec3 bn = texture(bumpMap, vec2(vUv.x, 1.0 - vUv.y)).rgb * 2.0 - 1.0;\n                    bn.x *= bumpIntensity;\n                    bn.y *= bumpIntensity;\n\n                    // Tangent space to modelview space\n                    n = normalize(bn);\n                } else {\n                    s = normalize(s);\n                    v = normalize(v);\n                    n = normalize(n);\n                }   \n\n                ambient = Ia * mambient.xyz;\n                diffuse = Id * mdiffuse.xyz * max(dot(s,n), 0.0);\n                vec3 r = reflect(-s, n);\n                spec   =  Is * vec3(1.0, 1.0, 1.0) * pow(max(dot(r,v), 0.0), specularExponent);\n            } \n        \n            void main() {\n                vec3 ambientSum = vec3(0);\n                vec3 diffuseSum = vec3(0);\n                vec3 specSum = vec3(0);\n                vec3 ambient, diffuse, spec;\n\n                for (int i = 0; i < numLights; ++i) {\n                    light(i, vPosViewSpace, vNormalViewSpace, ambient, diffuse, spec);\n                    ambientSum += ambient;\n                    diffuseSum += diffuse;\n                    specSum += spec;\n                }             \n                ambientSum /= float(numLights);\n            \n                if (displayNormalMap && hasNormalMap) {\n                    vec4 bumpColor = texture(bumpMap, vec2(vUv.x, 1.0 - vUv.y));\n                    outColor = bumpColor;\n                } else if (displaySpecularMap && hasSpecularMap) {\n                    outColor = texture(specularMap, vec2(vUv.x, 1.0 - vUv.y));\n                }  else if (hasDiffuseMap) {\n\n                    // vec4 specColor = vec4(0);\n                    // if (hasSpecularMap) {\n                    //   specColor = vec4(1);\n                    //   \n                    // }\n                    vec4 specularMapColor = texture(specularMap, vec2(vUv.x, 1.0 - vUv.y));\n                    vec4 texColor = texture(textureMap, vec2(vUv.x, 1.0 - vUv.y));\n                    outColor = vec4(diffuseSum, 1.0) * texColor + vec4(specSum, 1.0) * specularMapColor * float(hasSpecularMap);\n                } else {\n                    outColor = vec4(1.0, 0.0, 0.0, 1.0);\n                    //outColor = vec4(diffuseSum  , 1.0) + vec4(specSum, 1.0);\n                }\n            }\n        `;const t=Object(i.b)();this.program=Object(r.a)(t,"#version 300 es\n            precision mediump int;\n            precision mediump float;\n\n            layout (std140) uniform modelMatrices {\n                mat4 modelMatrix;\n                mat4 normalMatrix;\n            };\n    \n            layout (std140) uniform sceneMatrices {\n                mat4 viewMatrix;\n                mat4 projectionMatrix;\n            };\n\n            in vec3 position;\n            in vec3 normal;\n            in vec2 uv;\n\n            in vec3 tangent;\n            in vec3 bitangent;\n            \n            out vec3 vPosViewSpace;\n            out vec2 vUv;\n\n            out vec3 vNormalViewSpace;\n            out vec3 vTangentViewSpace;\n            out vec3 vBitangentViewSpace;\n\n            out mat3 TBN;\n\n            void main() {\n                mat4 modelViewMatrix = viewMatrix * modelMatrix;\n                                \n                vNormalViewSpace = vec3(mat3(modelViewMatrix) * normalize(normal));\n                vTangentViewSpace = vec3(mat3(modelViewMatrix) * normalize(tangent));\n                vBitangentViewSpace = vec3(mat3(modelViewMatrix) * normalize(bitangent));\n            \n                // Transpose is ok since we don't do non-uniform scaling\n                TBN = transpose(mat3(\n                    vTangentViewSpace,\n                    vBitangentViewSpace,\n                    vNormalViewSpace\n                ));\n                \n                vPosViewSpace = vec3(modelViewMatrix * vec4(position, 1.0));\n                vUv = uv;\n                gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n            }\n        ","#version 300 es\n            precision mediump float;\n            precision mediump int;\n\n            const int MAX_DIRECTIONAL_LIGHTS = 16;\n\n            layout (std140) uniform sceneMatrices {\n                mat4 viewMatrix;\n                mat4 projectionMatrix;\n            };\n\n            layout (std140) uniform modelMatrices {\n                mat4 modelMatrix;\n                mat4 normalMatrix;\n            };\n\n            struct Directional {\n                vec3 positionViewSpace;\n                vec4 color;\n                float intensity;\n            };\n\n            layout (std140) uniform materialBuffer {\n                vec4 mambient; // 16 0 \n                vec4 mdiffuse; // 16 16\n                //vec4 memissive; // 16 32\n                vec4 mspecular; // 16 32\n                float specularExponent; // 4 48\n                float bumpIntensity; // 4 52\n                bool hasDiffuseMap; // 4 56\n                bool hasNormalMap; // 4 60\n                bool hasSpecularMap; // 4 64\n                bool displayNormalMap; // 4 68\n                bool displaySpecularMap;\n            };\n\n            layout (std140) uniform directionalBuffer {\n                Directional directionalLights[MAX_DIRECTIONAL_LIGHTS];\n            };\n\n            uniform int numLights;\n\n            // Textures\n            uniform sampler2D textureMap;\n            uniform sampler2D bumpMap;\n            uniform sampler2D specularMap;\n\n            in vec3 vPosViewSpace;\n            in vec3 vNormalViewSpace;\n\n            in vec3 vTangentViewSpace;\n            in vec3 vBitangentViewSpace;\n\n            in mat3 TBN;\n            in vec2 vUv;\n\n            // TODO: light uniforms\n            vec3 Ia = vec3(0.2);\n            vec3 Id = vec3(1.0);\n            vec3 Is = vec3(1.0);\n\n            out vec4 outColor;\n\n            void light(int lightIndex, vec3 vPos, vec3 norm, out vec3 ambient, out vec3 diffuse, out vec3 spec) {\n\n                // View space\n                vec3 n = norm;\n                vec3 s = directionalLights[lightIndex].positionViewSpace - vPos;\n                vec3 v = -vPos;\n\n                if (hasNormalMap) {\n                    // Convert from view to tangent space\n                    s = normalize(TBN * s);\n                    v = normalize(TBN * v);\n                    //n = normalize(n);\n\n                    vec3 bn = texture(bumpMap, vec2(vUv.x, 1.0 - vUv.y)).rgb * 2.0 - 1.0;\n                    bn.x *= bumpIntensity;\n                    bn.y *= bumpIntensity;\n\n                    // Tangent space to modelview space\n                    n = normalize(bn);\n                } else {\n                    s = normalize(s);\n                    v = normalize(v);\n                    n = normalize(n);\n                }   \n\n                ambient = Ia * mambient.xyz;\n                diffuse = Id * mdiffuse.xyz * max(dot(s,n), 0.0);\n                vec3 r = reflect(-s, n);\n                spec   =  Is * vec3(1.0, 1.0, 1.0) * pow(max(dot(r,v), 0.0), specularExponent);\n            } \n        \n            void main() {\n                vec3 ambientSum = vec3(0);\n                vec3 diffuseSum = vec3(0);\n                vec3 specSum = vec3(0);\n                vec3 ambient, diffuse, spec;\n\n                for (int i = 0; i < numLights; ++i) {\n                    light(i, vPosViewSpace, vNormalViewSpace, ambient, diffuse, spec);\n                    ambientSum += ambient;\n                    diffuseSum += diffuse;\n                    specSum += spec;\n                }             \n                ambientSum /= float(numLights);\n            \n                if (displayNormalMap && hasNormalMap) {\n                    vec4 bumpColor = texture(bumpMap, vec2(vUv.x, 1.0 - vUv.y));\n                    outColor = bumpColor;\n                } else if (displaySpecularMap && hasSpecularMap) {\n                    outColor = texture(specularMap, vec2(vUv.x, 1.0 - vUv.y));\n                }  else if (hasDiffuseMap) {\n\n                    // vec4 specColor = vec4(0);\n                    // if (hasSpecularMap) {\n                    //   specColor = vec4(1);\n                    //   \n                    // }\n                    vec4 specularMapColor = texture(specularMap, vec2(vUv.x, 1.0 - vUv.y));\n                    vec4 texColor = texture(textureMap, vec2(vUv.x, 1.0 - vUv.y));\n                    outColor = vec4(diffuseSum, 1.0) * texColor + vec4(specSum, 1.0) * specularMapColor * float(hasSpecularMap);\n                } else {\n                    outColor = vec4(1.0, 0.0, 0.0, 1.0);\n                    //outColor = vec4(diffuseSum  , 1.0) + vec4(specSum, 1.0);\n                }\n            }\n        "),this.programInfo={attribLocations:{position:t.getAttribLocation(this.program,"position"),normal:t.getAttribLocation(this.program,"normal"),uv:t.getAttribLocation(this.program,"uv"),tangent:t.getAttribLocation(this.program,"tangent"),bitangent:t.getAttribLocation(this.program,"bitangent"),materialId:t.getAttribLocation(this.program,"materialId")},uniformLocations:{numLights:t.getUniformLocation(this.program,"numLights")},uniformBlockLocations:{material:t.getUniformBlockIndex(this.program,"materialBuffer"),model:t.getUniformBlockIndex(this.program,"modelMatrices"),scene:t.getUniformBlockIndex(this.program,"sceneMatrices"),directional:t.getUniformBlockIndex(this.program,"directionalBuffer")}}}get materialData(){return this._materialData}bindTextures(){const e=Object(i.b)();let t;this._texture&&(e.activeTexture(e.TEXTURE0+0),this._texture.bind(),t=e.getUniformLocation(this.program,"textureMap"),e.uniform1i(t,0)),this._bumpMap&&(e.activeTexture(e.TEXTURE0+1),this._bumpMap.bind(),t=e.getUniformLocation(this.program,"bumpMap"),e.uniform1i(t,1)),this._specularMap&&(e.activeTexture(e.TEXTURE0+2),this._specularMap.bind(),t=e.getUniformLocation(this.program,"specularMap"),e.uniform1i(t,2))}activate(){Object(i.b)().useProgram(this.program)}}t.a=a},function(e,t,n){"use strict";var i=n(11),r=n(0),o=n(1);class a extends i.a{constructor(e,t,n,i){console.assert(e&&t&&n&&i),super(),this.fov=e*(Math.PI/180),this.ratio=t,this.near=n,this.far=i,this.target=r.c.create(),this.up=r.c.fromValues(0,1,0),this.projectionMatrix=r.a.create(),this.viewMatrix=r.a.create(),this.position[0]=0,this.position[1]=0,this.position[2]=10,this.updateProjectionMatrix()}setTarget(e){r.c.copy(this.target,e)}lookAt(){r.a.lookAt(this.viewMatrix,this.position,this.target,this.up)}updateProjectionMatrix(){Object(o.b)();r.a.perspective(this.projectionMatrix,this.fov,this.ratio,this.near,this.far)}}t.a=a},function(e,t,n){"use strict";var i=n(1),r=(n(0),n(5)),o=n(9);class a{constructor(e={}){e.map?(this._texture=new o.a,this._texture.createTexture(e.map),console.log("Created Texture!")):console.warn("Material must have a texture ATM!");`#version 300 es\n      uniform modelMatrices {\n        mat4 modelMatrix;\n        mat4 normalMatrix;\n      };\n\n      uniform sceneMatrices {\n        mat4 viewMatrix;\n        mat4 projectionMatrix;\n      };\n\n      in vec3 position;\n      in vec3 normal;\n      in vec2 uv;\n      in float materialId;\n\n      out vec3 vPosition;\n      out vec3 vNormal;\n      out vec2 vUv;\n      out float vMaterial;\n\n      void main() {\n        vNormal = normalize(vec3(normalMatrix * vec4(normal, 1.0)));\n        vUv = uv;\n        vPosition = vec3(viewMatrix * modelMatrix * vec4(position, 1.0));\n        vMaterial = materialId;\n        gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.0);\n      }\n    `,`#version 300 es\n      precision mediump float;\n\n      const int MAX_DIRECTIONAL_LIGHTS = 16;\n      const int MAX_MATERIALS = 16;\n\n      struct Directional {\n        vec4 color;\n        float intensity;\n        vec3 position;\n      };\n\n      struct Material {\n        vec3 ambient;\n      };\n\n      uniform materialBuffer {\n        Material materials[MAX_MATERIALS];\n      };\n\n      uniform directionalBuffer {\n        Directional directionalLights[MAX_DIRECTIONAL_LIGHTS];\n      };\n\n      uniform int numLights;\n      uniform vec3 color;\n      //uniform sampler2D textureMap;\n\n      vec3 ka = vec3(0.8);\n      vec3 kd = vec3(0.64, 0.48, 0.32);\n      vec3 ks = vec3(0.5, 0.5, 0.5);\n      float shininess = 96.078431;\n\n      vec3 Ia = vec3(0.3);\n      vec3 Id = vec3(0.5);\n      vec3 Is = vec3(0.5);\n\n      in vec3 vPosition;\n      in vec3 vNormal;\n      in vec2 vUv;\n      in float vMaterial;\n\n      out vec4 outColor;\n\n      void light(int lightIndex, vec3 pos, vec3 norm, out vec3 ambient, out vec3 diffuse, out vec3 spec) {\n        vec3 n = normalize(norm);\n        vec3 s = normalize(directionalLights[lightIndex].position - pos);\n        vec3 v = normalize(-pos);\n        vec3 r = reflect(-s,n);\n\n        ambient = Ia * ka;\n        float sDotN = max(dot(s,n), 0.0);\n        diffuse = Id * kd * sDotN;\n\n        spec = Is * ks * pow(max(dot(r,v) , 0.0 ), shininess);\n      }\n\n      void main() {\n        // vec3 ambientSum = vec3(0);\n        // vec3 diffuseSum = vec3(0);\n        // vec3 specSum = vec3(0);\n        // vec3 ambient, diffuse, spec;\n\n        // if (gl_FrontFacing) {\n        //   for (int i = 0; i < numLights; ++i) {\n        //     light(i, vPosition, vNormal, ambient, diffuse, spec);\n        //     ambientSum += ambient;\n        //     diffuseSum += diffuse;\n        //     specSum += spec;\n        //   }\n        // } else {\n        //   for (int i = 0; i < numLights; ++i) {\n        //     light(i, vPosition, -vNormal, ambient, diffuse, spec);\n        //     ambientSum += ambient;\n        //     diffuseSum += diffuse;\n        //     specSum += spec;\n        //   }\n        // }\n        // ambientSum /= float(numLights);\n\n        // vec4 texColor = texture(textureMap, vUv);\n        // outColor = vec4(ambientSum + diffuseSum, 1.0) * texColor + vec4(specSum, 1.0);\n        outColor = vec4(1.0, 1.0, 1.0, 1.0);\n      }\n    `;const t=Object(i.b)();this.uniforms={map:e.map||null,color:e.color||[1,1,1,1]},this.program=Object(r.a)(t,"#version 300 es\n      uniform modelMatrices {\n        mat4 modelMatrix;\n        mat4 normalMatrix;\n      };\n\n      uniform sceneMatrices {\n        mat4 viewMatrix;\n        mat4 projectionMatrix;\n      };\n\n      in vec3 position;\n      in vec3 normal;\n      in vec2 uv;\n      in float materialId;\n\n      out vec3 vPosition;\n      out vec3 vNormal;\n      out vec2 vUv;\n      out float vMaterial;\n\n      void main() {\n        vNormal = normalize(vec3(normalMatrix * vec4(normal, 1.0)));\n        vUv = uv;\n        vPosition = vec3(viewMatrix * modelMatrix * vec4(position, 1.0));\n        vMaterial = materialId;\n        gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.0);\n      }\n    ","#version 300 es\n      precision mediump float;\n\n      const int MAX_DIRECTIONAL_LIGHTS = 16;\n      const int MAX_MATERIALS = 16;\n\n      struct Directional {\n        vec4 color;\n        float intensity;\n        vec3 position;\n      };\n\n      struct Material {\n        vec3 ambient;\n      };\n\n      uniform materialBuffer {\n        Material materials[MAX_MATERIALS];\n      };\n\n      uniform directionalBuffer {\n        Directional directionalLights[MAX_DIRECTIONAL_LIGHTS];\n      };\n\n      uniform int numLights;\n      uniform vec3 color;\n      //uniform sampler2D textureMap;\n\n      vec3 ka = vec3(0.8);\n      vec3 kd = vec3(0.64, 0.48, 0.32);\n      vec3 ks = vec3(0.5, 0.5, 0.5);\n      float shininess = 96.078431;\n\n      vec3 Ia = vec3(0.3);\n      vec3 Id = vec3(0.5);\n      vec3 Is = vec3(0.5);\n\n      in vec3 vPosition;\n      in vec3 vNormal;\n      in vec2 vUv;\n      in float vMaterial;\n\n      out vec4 outColor;\n\n      void light(int lightIndex, vec3 pos, vec3 norm, out vec3 ambient, out vec3 diffuse, out vec3 spec) {\n        vec3 n = normalize(norm);\n        vec3 s = normalize(directionalLights[lightIndex].position - pos);\n        vec3 v = normalize(-pos);\n        vec3 r = reflect(-s,n);\n\n        ambient = Ia * ka;\n        float sDotN = max(dot(s,n), 0.0);\n        diffuse = Id * kd * sDotN;\n\n        spec = Is * ks * pow(max(dot(r,v) , 0.0 ), shininess);\n      }\n\n      void main() {\n        // vec3 ambientSum = vec3(0);\n        // vec3 diffuseSum = vec3(0);\n        // vec3 specSum = vec3(0);\n        // vec3 ambient, diffuse, spec;\n\n        // if (gl_FrontFacing) {\n        //   for (int i = 0; i < numLights; ++i) {\n        //     light(i, vPosition, vNormal, ambient, diffuse, spec);\n        //     ambientSum += ambient;\n        //     diffuseSum += diffuse;\n        //     specSum += spec;\n        //   }\n        // } else {\n        //   for (int i = 0; i < numLights; ++i) {\n        //     light(i, vPosition, -vNormal, ambient, diffuse, spec);\n        //     ambientSum += ambient;\n        //     diffuseSum += diffuse;\n        //     specSum += spec;\n        //   }\n        // }\n        // ambientSum /= float(numLights);\n\n        // vec4 texColor = texture(textureMap, vUv);\n        // outColor = vec4(ambientSum + diffuseSum, 1.0) * texColor + vec4(specSum, 1.0);\n        outColor = vec4(1.0, 1.0, 1.0, 1.0);\n      }\n    "),this.programInfo={attribLocations:{position:t.getAttribLocation(this.program,"position"),material:t.getAttribLocation(this.program,"materialId"),normal:t.getAttribLocation(this.program,"normal"),uv:t.getAttribLocation(this.program,"uv")},uniformLocations:{numLights:t.getUniformLocation(this.program,"numLights"),projectionMatrix:t.getUniformLocation(this.program,"projectionMatrix"),modelViewMatrix:t.getUniformLocation(this.program,"modelViewMatrix"),normalMatrix:t.getUniformLocation(this.program,"normalMatrix")}}}setUniform(e,t){const n=Object(i.b)();switch(e){case"numLights":n.uniform1i(this.programInfo.uniformLocations.numLights,t);break;default:console.warn("Unknown Uniform")}}activate(){Object(i.b)().useProgram(this.program)}}t.a=a},function(e,t,n){"use strict";var i=n(1),r=(n(0),n(5));class o{constructor(e={}){console.assert(e.color),this.color=e.color;`#version 300 es\n      uniform perModel {\n        mat4 modelMatrix;\n        mat4 normalMatrix;\n      };\n\n      uniform perScene {\n        mat4 viewMatrix;\n        mat4 projectionMatrix;\n      };\n\n      in vec3 position;\n      in vec3 normal;\n\n      out vec3 vPosition;\n      out vec3 vNormal;\n\n      void main() {\n        vNormal = normalize(vec3(normalMatrix * vec4(normal, 1.0)));\n        vPosition = vec3(viewMatrix * modelMatrix * vec4(position, 1.0));\n        // TODO texcoord\n        gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.0);\n      }\n    `,`#version 300 es\n      precision mediump float;\n\n      const int MAX_DIRECTIONAL_LIGHTS = 16;\n\n      struct Directional {\n        vec4 color;\n        float intensity;\n        vec3 position;\n      };\n\n      uniform directional {\n        Directional directionalLights[MAX_DIRECTIONAL_LIGHTS];\n      };\n\n      uniform int numLights;\n      uniform vec3 color;\n\n      vec3 ka = vec3(0.0);\n      vec3 kd = vec3(0.64, 0.48, 0.32);\n\n      vec3 Ia = vec3(0.0);\n      vec3 Id = vec3(0.5);\n\n      in vec3 vPosition;\n      in vec3 vNormal;\n\n      out vec4 outColor;\n\n      void light(int lightIndex, vec3 pos, vec3 norm, out vec3 ambient, out vec3 diffuse) {\n        vec3 n = normalize(norm);\n        vec3 s = normalize(directionalLights[lightIndex].position - pos);\n\n        ambient = Ia * ka;\n        float sDotN = max(dot(s,n), 0.0);\n        diffuse = Id * kd * sDotN;\n      }\n\n\n      void main() {\n        vec3 ambientSum = vec3(0);\n        vec3 diffuseSum = vec3(0);\n        vec3 ambient, diffuse, spec;\n\n        if (gl_FrontFacing) {\n          for (int i = 0; i < numLights; ++i) {\n            light(i, vPosition, vNormal, ambient, diffuse);\n            ambientSum += ambient;\n            diffuseSum += diffuse;\n          }\n        } else {\n          for (int i = 0; i < numLights; ++i) {\n            light(i, vPosition, -vNormal, ambient, diffuse);\n            ambientSum += ambient;\n            diffuseSum += diffuse;\n          }\n        }\n        ambientSum /= float(numLights);\n\n        //vec4 texColor = texture(Tex, data.TexCoord);\n        outColor = vec4(ambientSum + diffuseSum, 1.0);\n      }\n    `;const t=Object(i.b)();this.program=Object(r.a)(t,"#version 300 es\n      uniform perModel {\n        mat4 modelMatrix;\n        mat4 normalMatrix;\n      };\n\n      uniform perScene {\n        mat4 viewMatrix;\n        mat4 projectionMatrix;\n      };\n\n      in vec3 position;\n      in vec3 normal;\n\n      out vec3 vPosition;\n      out vec3 vNormal;\n\n      void main() {\n        vNormal = normalize(vec3(normalMatrix * vec4(normal, 1.0)));\n        vPosition = vec3(viewMatrix * modelMatrix * vec4(position, 1.0));\n        // TODO texcoord\n        gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.0);\n      }\n    ","#version 300 es\n      precision mediump float;\n\n      const int MAX_DIRECTIONAL_LIGHTS = 16;\n\n      struct Directional {\n        vec4 color;\n        float intensity;\n        vec3 position;\n      };\n\n      uniform directional {\n        Directional directionalLights[MAX_DIRECTIONAL_LIGHTS];\n      };\n\n      uniform int numLights;\n      uniform vec3 color;\n\n      vec3 ka = vec3(0.0);\n      vec3 kd = vec3(0.64, 0.48, 0.32);\n\n      vec3 Ia = vec3(0.0);\n      vec3 Id = vec3(0.5);\n\n      in vec3 vPosition;\n      in vec3 vNormal;\n\n      out vec4 outColor;\n\n      void light(int lightIndex, vec3 pos, vec3 norm, out vec3 ambient, out vec3 diffuse) {\n        vec3 n = normalize(norm);\n        vec3 s = normalize(directionalLights[lightIndex].position - pos);\n\n        ambient = Ia * ka;\n        float sDotN = max(dot(s,n), 0.0);\n        diffuse = Id * kd * sDotN;\n      }\n\n\n      void main() {\n        vec3 ambientSum = vec3(0);\n        vec3 diffuseSum = vec3(0);\n        vec3 ambient, diffuse, spec;\n\n        if (gl_FrontFacing) {\n          for (int i = 0; i < numLights; ++i) {\n            light(i, vPosition, vNormal, ambient, diffuse);\n            ambientSum += ambient;\n            diffuseSum += diffuse;\n          }\n        } else {\n          for (int i = 0; i < numLights; ++i) {\n            light(i, vPosition, -vNormal, ambient, diffuse);\n            ambientSum += ambient;\n            diffuseSum += diffuse;\n          }\n        }\n        ambientSum /= float(numLights);\n\n        //vec4 texColor = texture(Tex, data.TexCoord);\n        outColor = vec4(ambientSum + diffuseSum, 1.0);\n      }\n    "),this.programInfo={attribLocations:{position:t.getAttribLocation(this.program,"position"),normal:t.getAttribLocation(this.program,"normal")},uniformLocations:{numLights:t.getUniformLocation(this.program,"numLights"),color:t.getUniformLocation(this.program,"color"),projectionMatrix:t.getUniformLocation(this.program,"projectionMatrix"),modelViewMatrix:t.getUniformLocation(this.program,"modelViewMatrix"),normalMatrix:t.getUniformLocation(this.program,"normalMatrix")}}}setUniform(e,t){const n=Object(i.b)();switch(e){case"numLights":n.uniform1i(this.programInfo.uniformLocations.numLights,t);break;case"dLightPosition":n.uniform3fv(this.programInfo.uniformLocations.dLightPosition,t);break;case"dLightIntensity":n.uniform1f(this.programInfo.uniformLocations.dLightIntensity,t);break;case"modelViewMatrix":n.uniformMatrix4fv(this.programInfo.uniformLocations.modelViewMatrix,!1,t);break;case"projectionMatrix":n.uniformMatrix4fv(this.programInfo.uniformLocations.projectionMatrix,!1,t);break;case"normalMatrix":n.uniformMatrix4fv(this.programInfo.uniformLocations.normalMatrix,!1,t);break;default:console.warn("Unknown Uniform")}}setInternalUniforms(){Object(i.b)().uniform3fv(this.programInfo.uniformLocations.color,this.color)}activate(){Object(i.b)().useProgram(this.program)}}t.a=o},function(e,t,n){"use strict";(function(e){function i(e,t,n){return e<=t?t:e>=n?n:e}var r=n(0),o=n(1);const a=.5*-Math.PI;class s{constructor(t){const n=Object(o.b)();this.camera=t,this.domElement=n.canvas,this.radius=Math.max(t.position[0],t.position[2]),this.rx=Math.atan2(t.position[1],this.radius),this.ry=Math.atan2(t.position[2],t.position[0])+a,this.ox=0,this.oy=0,this.width=e.innerWidth,this.height=e.innerHeight,this.rotationSpeed=5*e.devicePixelRatio,this.zoomMin=.1,this.zoomMax=1/0,this.zoomSpeed=100,this.isDown=!1,this._listen()}_listen(){this.domElement.addEventListener("mousedown",this._onStart.bind(this),!1),this.domElement.addEventListener("mousemove",this._onMove.bind(this),!1),this.domElement.addEventListener("mouseup",this._onEnd.bind(this),!1),this.domElement.addEventListener("touchstart",this._onStart.bind(this),!1),this.domElement.addEventListener("touchmove",this._onMove.bind(this),!1),this.domElement.addEventListener("touchend",this._onEnd.bind(this),!1),e.addEventListener("mousewheel",this._onWheel.bind(this),!1)}_onStart(e){e.preventDefault(),this.oy=this.ry,this.ox=this.rx,this._startY=e.pageX/this.width,this._startX=e.pageY/this.height,this.isDown=!0}_onMove(e){if(this.isDown){const t=e.pageX/this.width,n=e.pageY/this.height;this.rx=this.ox+-(this._startX-n)*this.rotationSpeed,this.ry=this.oy+(this._startY-t)*this.rotationSpeed,this.rx=i(this.rx,.5*-Math.PI,.5*Math.PI)}}_onEnd(){this.isDown=!1}_onWheel(e){e.preventDefault();let t=0;e.wheelDelta?t=e.wheelDelta:e.detail&&(t=e.detail),this._zoom(-t)}_zoom(e){this.radius+=e/1e3*this.zoomSpeed,this.radius=i(this.radius,this.zoomMin,this.zoomMax)}update(){const e=this.radius*Math.sin(this.rx),t=this.radius*Math.cos(this.rx),n=Math.sin(this.ry)*t,i=Math.cos(this.ry)*t;r.c.set(this.camera.position,n,e,i),this.camera.lookAt()}}t.a=s}).call(t,n(3))},function(e,t,n){"use strict";var i=n(0),r=n(1);t.a=function(e,t){function n(e,t){return function(){t.apply(e,arguments)}}function o(e){e.preventDefault()}const a=Object(r.b)();this.camera=e,this.domElement=a.canvas,this.movementSpeed=25.5,this.rollSpeed=.22,this.dragToLook=!0,this.autoForward=!1,this.mouseStatus=0,this.moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this.moveVector=i.c.create(),this.rotationVector=i.c.create(),this.isDirty=!1,this.keydown=function(e){if(!e.altKey){switch(e.keyCode){case 16:this.movementSpeedMultiplier=.1;break;case 87:this.moveState.forward=1;break;case 83:this.moveState.back=1;break;case 65:this.moveState.left=1;break;case 68:this.moveState.right=1;break;case 82:this.moveState.up=1;break;case 70:this.moveState.down=1;break;case 38:this.moveState.pitchUp=1;break;case 40:this.moveState.pitchDown=1;break;case 37:this.moveState.yawLeft=1;break;case 39:this.moveState.yawRight=1;break;case 81:this.moveState.rollLeft=1;break;case 69:this.moveState.rollRight=1}this.updateMovementVector(),this.updateRotationVector()}},this.keyup=function(e){switch(e.keyCode){case 16:this.movementSpeedMultiplier=1;break;case 87:this.moveState.forward=0;break;case 83:this.moveState.back=0;break;case 65:this.moveState.left=0;break;case 68:this.moveState.right=0;break;case 82:this.moveState.up=0;break;case 70:this.moveState.down=0;break;case 38:this.moveState.pitchUp=0;break;case 40:this.moveState.pitchDown=0;break;case 37:this.moveState.yawLeft=0;break;case 39:this.moveState.yawRight=0;break;case 81:this.moveState.rollLeft=0;break;case 69:this.moveState.rollRight=0}this.updateMovementVector(),this.updateRotationVector()},this.mousedown=function(e){if(this.domElement!==document&&this.domElement.focus(),e.preventDefault(),e.stopPropagation(),this.dragToLook)this.mouseStatus++;else{switch(e.button){case 0:this.moveState.forward=1;break;case 2:this.moveState.back=1}this.updateMovementVector()}},this.mousemove=function(e){if(!this.dragToLook||this.mouseStatus>0){var t=this.getContainerDimensions(),n=t.size[0]/2,i=t.size[1]/2;this.moveState.yawLeft=-(e.pageX-t.offset[0]-n)/n,this.moveState.pitchDown=(e.pageY-t.offset[1]-i)/i,this.updateRotationVector()}},this.mouseup=function(e){if(e.preventDefault(),e.stopPropagation(),this.dragToLook)this.mouseStatus--,this.moveState.yawLeft=this.moveState.pitchDown=0;else{switch(e.button){case 0:this.moveState.forward=0;break;case 2:this.moveState.back=0}this.updateMovementVector()}this.updateRotationVector()},this.update=function(e=.9){const t=e*this.movementSpeed,n=1*e*this.rollSpeed,r=this.camera.viewMatrix,o=i.c.create();o[0]=r[0],o[1]=r[4],o[2]=r[8];const a=i.c.create();a[0]=r[2],a[1]=r[6],a[2]=r[10];const s=i.c.create();s[0]=r[1],s[1]=r[5],s[2]=r[11];const u=-this.moveVector[2],c=this.moveVector[1],l=this.moveVector[0];this.camera.position[0]+=(-u*a[0]+c*s[0]+l*o[0])*t,this.camera.position[1]+=(-u*a[1]+c*s[1]+l*o[1])*t,this.camera.position[2]+=(-u*a[2]+c*s[2]+l*o[2])*t,this.camera.rotation[0]+=this.rotationVector[0]*n,this.camera.rotation[1]+=this.rotationVector[1]*n,this.camera.rotation[2]+=this.rotationVector[2]*n,i.b.identity(this.camera.quaternion),i.b.rotateX(this.camera.quaternion,this.camera.quaternion,this.camera.rotation[0]),i.b.rotateZ(this.camera.quaternion,this.camera.quaternion,this.camera.rotation[2]),i.b.rotateY(this.camera.quaternion,this.camera.quaternion,this.camera.rotation[1]);const h=i.b.getAxisAngle(this.camera.quaternionAxisAngle,this.camera.quaternion);i.a.identity(this.camera.viewMatrix);const f=i.c.create();i.c.negate(f,this.camera.position),i.a.rotate(this.camera.viewMatrix,this.camera.viewMatrix,h,this.camera.quaternionAxisAngle),i.a.translate(this.camera.viewMatrix,this.camera.viewMatrix,f)},this.updateMovementVector=function(){const e=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector[0]=-this.moveState.left+this.moveState.right,this.moveVector[1]=-this.moveState.down+this.moveState.up,this.moveVector[2]=-e+this.moveState.back},this.updateRotationVector=function(){this.rotationVector[0]=this.moveState.pitchDown-this.moveState.pitchUp,this.rotationVector[1]=this.moveState.yawRight-this.moveState.yawLeft,this.rotationVector[2]=this.moveState.rollRight-this.moveState.rollLeft,this.isDirty=!0},this.getContainerDimensions=function(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}},this.dispose=function(){this.domElement.removeEventListener("contextmenu",o,!1),this.domElement.removeEventListener("mousedown",u,!1),this.domElement.removeEventListener("mousemove",s,!1),this.domElement.removeEventListener("mouseup",c,!1),window.removeEventListener("keydown",l,!1),window.removeEventListener("keyup",h,!1)};var s=n(this,this.mousemove),u=n(this,this.mousedown),c=n(this,this.mouseup),l=n(this,this.keydown),h=n(this,this.keyup);this.domElement.addEventListener("contextmenu",o,!1),this.domElement.addEventListener("mousemove",s,!1),this.domElement.addEventListener("mousedown",u,!1),this.domElement.addEventListener("mouseup",c,!1),window.addEventListener("keydown",l,!1),window.addEventListener("keyup",h,!1),this.updateMovementVector(),this.updateRotationVector()}},function(e,t,n){"use strict";var i=n(12),r=n(53);class o{constructor(){}load(e){return new Promise(t=>{r.downloadMeshes(e,e=>{let n=[];Object.entries(e).forEach(([e,t])=>{const r=!t.vertexNormals||!t.vertexNormals.length||isNaN(t.vertexNormals[0]);r&&console.log("Generating normals manually ...",t);const o={positions:t.vertices,normals:r?Object(i.b)(t.vertices,t.indices):t.vertexNormals,indices:t.indices,uvs:t.textures};n.push(o)}),t(n)})})}loadModelsAndMaterials(e){return new Promise(t=>{r.downloadModels(e).then(e=>{let n=[];setTimeout(()=>{Object.entries(e).forEach(([e,t])=>{const r=!t.vertexNormals||!t.vertexNormals.length||isNaN(t.vertexNormals[0]),o=!t.textures||!t.textures.length||isNaN(t.textures[0]);r&&console.info("Generating normals manually ...",e),o&&console.info("Generating UVs manually...",e);const a={name:e,objectData:{positions:t.vertices,normals:r?Object(i.b)(t.vertices,t.indices):t.vertexNormals,tangents:t.tangents,bitangents:t.bitangents,indices:t.indices,indicesByMaterial:t.vertexBuffersByMaterialIndex,uvs:o?Object(i.c)(t.vertices):t.textures},materialData:{vertexMaterialIndices:t.vertexMaterialIndices,materialIndices:t.materialIndices,materialNames:t.materialNames,materialsByIndex:t.materialsByIndex}};n.push(a)}),t(n)},5e3)})})}}t.a=o},function(e,t,n){!function(t,n){e.exports=n()}(0,function(){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=3)}([function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e){switch(e){case"BYTE":case"UNSIGNED_BYTE":return 1;case"SHORT":case"UNSIGNED_SHORT":return 2;case"FLOAT":return 4}}Object.defineProperty(t,"__esModule",{value:!0});var o=t.Layout=function e(){i(this,e);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];this.attributes=n;var o=0,s=0,u=!0,c=!1,l=void 0;try{for(var h,f=n[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var d=h.value;if(this[d.key])throw new a(d);o%d.sizeOfType!=0&&(o+=d.sizeOfType-o%d.sizeOfType,console.warn("Layout requires padding before "+d.key+" attribute")),this[d.key]={attribute:d,size:d.size,type:d.type,normalized:d.normalized,offset:o},o+=d.sizeInBytes,s=Math.max(s,d.sizeOfType)}}catch(e){c=!0,l=e}finally{try{!u&&f.return&&f.return()}finally{if(c)throw l}}o%s!=0&&(o+=s-o%s,console.warn("Layout requires padding at the back")),this.stride=o;var p=!0,m=!1,v=void 0;try{for(var g,b=n[Symbol.iterator]();!(p=(g=b.next()).done);p=!0)this[g.value.key].stride=this.stride}catch(e){m=!0,v=e}finally{try{!p&&b.return&&b.return()}finally{if(m)throw v}}},a=function e(t){i(this,e),this.message="found duplicate attribute: "+t.key},s=function e(t,n,o){arguments.length>3&&void 0!==arguments[3]&&arguments[3];i(this,e),this.key=t,this.size=n,this.type=o,this.normalized=!1,this.sizeOfType=r(o),this.sizeInBytes=this.sizeOfType*n};o.POSITION=new s("position",3,"FLOAT"),o.NORMAL=new s("normal",3,"FLOAT"),o.TANGENT=new s("tangent",3,"FLOAT"),o.BITANGENT=new s("bitangent",3,"FLOAT"),o.UV=new s("uv",2,"FLOAT"),o.MATERIAL_INDEX=new s("materialIndex",1,"SHORT"),o.MATERIAL_ENABLED=new s("materialEnabled",1,"UNSIGNED_SHORT"),o.AMBIENT=new s("ambient",3,"FLOAT"),o.DIFFUSE=new s("diffuse",3,"FLOAT"),o.SPECULAR=new s("specular",3,"FLOAT"),o.SPECULAR_EXPONENT=new s("specularExponent",3,"FLOAT"),o.EMISSIVE=new s("emissive",3,"FLOAT"),o.TRANSMISSION_FILTER=new s("transmissionFilter",3,"FLOAT"),o.DISSOLVE=new s("dissolve",1,"FLOAT"),o.ILLUMINATION=new s("illumination",1,"UNSIGNED_SHORT"),o.REFRACTION_INDEX=new s("refractionIndex",1,"FLOAT"),o.SHARPNESS=new s("sharpness",1,"FLOAT"),o.MAP_DIFFUSE=new s("mapDiffuse",1,"SHORT"),o.MAP_AMBIENT=new s("mapAmbient",1,"SHORT"),o.MAP_SPECULAR=new s("mapSpecular",1,"SHORT"),o.MAP_SPECULAR_EXPONENT=new s("mapSpecularExponent",1,"SHORT"),o.MAP_DISSOLVE=new s("mapDissolve",1,"SHORT"),o.ANTI_ALIASING=new s("antiAliasing",1,"UNSIGNED_SHORT"),o.MAP_BUMP=new s("mapBump",1,"SHORT"),o.MAP_DISPLACEMENT=new s("mapDisplacement",1,"SHORT"),o.MAP_DECAL=new s("mapDecal",1,"SHORT"),o.MAP_EMISSIVE=new s("mapEmissive",1,"SHORT")},function(e,t,n){"use strict";function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(0),s=function(){function e(t,n){r(this,e),(n=n||{}).materials=n.materials||[];var o=this;o.has_materials=!!n.materials,o.materials={},o.vertices=[],o.vertexNormals=[],o.textures=[],o.indices=[],this.name="";var a=[],s=[],u=[],c={},l=[],h={},f=[],d=-1;c.verts=[],c.norms=[],c.textures=[],c.hashindices={},c.indices=[],c.materialIndices=[],c.tangents=[],c.bitangents=[],c.index=0;var p=/^v\s/,m=/^vn\s/,v=/^vt\s/,g=/^f\s/,b=/\s+/,_=/^usemtl/,y=t.split("\n");for(var w=0;w<y.length;w++){var M=y[w].trim();if(M&&!M.startsWith("#")){var x=M.split(b);if(x.shift(),p.test(M))0,console.assert(3===x.length,"ERROR In VERTEX SPEC"),a.push.apply(a,i(x));else if(m.test(M))0,console.assert(3===x.length,"ERROR In NORMAL SPEC"),s.push.apply(s,i(x));else if(v.test(M))0,u.push.apply(u,i(x));else if(_.test(M)){var S=x[0];S in h||(l.push(S),f.push([]),h[S]=l.length-1),d=h[S]}else if(g.test(M)){0;var E=!1;console.assert(3===x.length,"Only supporting triangles ATM");for(var A=0,L=x.length;A<L;A++){3!==A||E||(A=2,E=!0);var T=x[0]+","+d,R=x[A]+","+d;if(R in c.hashindices)c.indices.push(c.hashindices[R]),c.tangents[c.hashindices[R]]=f[d].push(c.hashindices[R]);else{var k=x[A].split("/"),C=k.length-1;c.verts.push(+a[3*(k[0]-1)+0]),c.verts.push(+a[3*(k[0]-1)+1]),c.verts.push(+a[3*(k[0]-1)+2]),u.length&&(c.textures.push(+u[2*(k[1]-1)+0]),c.textures.push(+u[2*(k[1]-1)+1])),c.norms.push(+s[3*(k[C]-1)+0]),c.norms.push(+s[3*(k[C]-1)+1]),c.norms.push(+s[3*(k[C]-1)+2]),c.materialIndices.push(d),c.hashindices[R]=c.index,c.indices.push(c.index),f[d].push(c.hashindices[R]),c.index+=1}3===A&&E&&(f[d].push(c.hashindices[T]),c.indices.push(c.hashindices[T]))}}}}c.tangents=[...new Array(c.verts.length)].map(e=>0),c.bitangents=[...new Array(c.verts.length)].map(e=>0);{const e=c.indices,t=c.verts,n=c.textures,i=c.norms;for(let r=0;r<e.length;r+=3){const o=e[r+0],a=e[r+1],s=e[r+2],u=t[3*o+0],l=t[3*o+1],h=t[3*o+2],f=n[2*o+0],d=n[2*o+1],p=t[3*a+0],m=t[3*a+1],v=t[3*a+2],g=n[2*a+0],b=n[2*a+1],_=p-u,y=m-l,w=v-h,M=t[3*s+0]-u,x=t[3*s+1]-l,S=t[3*s+2]-h,E=g-f,A=b-d,L=n[2*s+0]-f,T=n[2*s+1]-d,R=E*T-A*L,k=1/(Math.abs(R<1e-4)?1:R),C=(_*T-M*A)*k,I=(y*T-x*A)*k,O=(w*T-S*A)*k,B=(M*E-_*L)*k,P=(x*E-y*L)*k,N=(S*E-w*L)*k,D=i[3*o+0],U=i[3*o+1],F=i[3*o+2],j=i[3*a+0],V=i[3*a+1],z=i[3*a+2],H=i[3*s+0],q=i[3*s+1],Y=i[3*s+2],X=C*D+I*U+O*F,G=C*j+I*V+O*z,W=C*H+I*q+O*Y,K=C-D*X,J=I-U*X,Q=O-F*X,Z=C-j*G,$=I-V*G,ee=O-z*G,te=C-H*W,ne=I-q*W,ie=O-Y*W,re=Math.sqrt(K*K+J*J+Q*Q),oe=Math.sqrt(Z*Z+$*$+ee*ee),ae=Math.sqrt(te*te+ne*ne+ie*ie),se=B*D+P*U+N*F,ue=B*j+P*V+N*z,ce=B*H+P*q+N*Y,le=B-D*se,he=P-U*se,fe=N-F*se,de=B-j*ue,pe=P-V*ue,me=N-z*ue,ve=B-H*ce,ge=P-q*ce,be=N-Y*ce,_e=Math.sqrt(le*le+he*he+fe*fe),ye=Math.sqrt(de*de+pe*pe+me*me),we=Math.sqrt(ve*ve+ge*ge+be*be);c.tangents[3*o+0]+=K/re,c.tangents[3*o+1]+=J/re,c.tangents[3*o+2]+=Q/re,c.tangents[3*a+0]+=Z/oe,c.tangents[3*a+1]+=$/oe,c.tangents[3*a+2]+=ee/oe,c.tangents[3*s+0]+=te/ae,c.tangents[3*s+1]+=ne/ae,c.tangents[3*s+2]+=ie/ae,c.bitangents[3*o+0]+=le/_e,c.bitangents[3*o+1]+=he/_e,c.bitangents[3*o+2]+=fe/_e,c.bitangents[3*a+0]+=de/ye,c.bitangents[3*a+1]+=pe/ye,c.bitangents[3*a+2]+=me/ye,c.bitangents[3*s+0]+=ve/we,c.bitangents[3*s+1]+=ge/we,c.bitangents[3*s+2]+=be/we}}o.vertices=c.verts,o.vertexNormals=c.norms,o.textures=c.textures,o.vertexMaterialIndices=c.materialIndices,o.indices=c.indices,o.vertexBuffersByMaterialIndex=f,o.tangents=c.tangents,o.bitangents=c.bitangents,o.materialNames=l,o.materialIndices=h,o.materialsByIndex={}}return o(e,[{key:"makeBufferData",value:function(e){var t=this.vertices.length/3,n=new ArrayBuffer(e.stride*t);n.numItems=t;for(var i=new DataView(n),r=0,o=0;r<t;r++){o=r*e.stride;var s=!0,u=!1,c=void 0;try{for(var l,h=e.attributes[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=l.value,d=o+e[f.key].offset;switch(f.key){case a.Layout.POSITION.key:i.setFloat32(d,this.vertices[3*r],!0),i.setFloat32(d+4,this.vertices[3*r+1],!0),i.setFloat32(d+8,this.vertices[3*r+2],!0);break;case a.Layout.UV.key:i.setFloat32(d,this.textures[2*r],!0),i.setFloat32(d+4,this.vertices[2*r+1],!0);break;case a.Layout.NORMAL.key:i.setFloat32(d,this.vertexNormals[3*r],!0),i.setFloat32(d+4,this.vertexNormals[3*r+1],!0),i.setFloat32(d+8,this.vertexNormals[3*r+2],!0);break;case a.Layout.MATERIAL_INDEX.key:i.setInt16(d,this.vertexMaterialIndices[r],!0);break;case a.Layout.AMBIENT.key:var p=this.vertexMaterialIndices[r],m=this.materialsByIndex[p];if(!m){console.warn('Material "'+this.materialNames[p]+'" not found in mesh. Did you forget to call addMaterialLibrary(...)?"');break}i.setFloat32(d,m.ambient[0],!0),i.setFloat32(d+4,m.ambient[1],!0),i.setFloat32(d+8,m.ambient[2],!0);break;case a.Layout.DIFFUSE.key:var v=this.vertexMaterialIndices[r],g=this.materialsByIndex[v];if(!g){console.warn('Material "'+this.materialNames[v]+'" not found in mesh. Did you forget to call addMaterialLibrary(...)?"');break}i.setFloat32(d,g.diffuse[0],!0),i.setFloat32(d+4,g.diffuse[1],!0),i.setFloat32(d+8,g.diffuse[2],!0);break;case a.Layout.SPECULAR.key:var b=this.vertexMaterialIndices[r],_=this.materialsByIndex[b];if(!_){console.warn('Material "'+this.materialNames[b]+'" not found in mesh. Did you forget to call addMaterialLibrary(...)?"');break}i.setFloat32(d,_.specular[0],!0),i.setFloat32(d+4,_.specular[1],!0),i.setFloat32(d+8,_.specular[2],!0);break;case a.Layout.SPECULAR_EXPONENT.key:var y=this.vertexMaterialIndices[r],w=this.materialsByIndex[y];if(!w){console.warn('Material "'+this.materialNames[y]+'" not found in mesh. Did you forget to call addMaterialLibrary(...)?"');break}i.setFloat32(d,w.specularExponent,!0);break;case a.Layout.EMISSIVE.key:var M=this.vertexMaterialIndices[r],x=this.materialsByIndex[M];if(!x){console.warn('Material "'+this.materialNames[M]+'" not found in mesh. Did you forget to call addMaterialLibrary(...)?"');break}i.setFloat32(d,x.emissive[0],!0),i.setFloat32(d+4,x.emissive[1],!0),i.setFloat32(d+8,x.emissive[2],!0);break;case a.Layout.TRANSMISSION_FILTER.key:var S=this.vertexMaterialIndices[r],E=this.materialsByIndex[S];if(!E){console.warn('Material "'+this.materialNames[S]+'" not found in mesh. Did you forget to call addMaterialLibrary(...)?"');break}i.setFloat32(d,E.transmissionFilter[0],!0),i.setFloat32(d+4,E.transmissionFilter[1],!0),i.setFloat32(d+8,E.transmissionFilter[2],!0);break;case a.Layout.DISSOLVE.key:var A=this.vertexMaterialIndices[r],L=this.materialsByIndex[A];if(!L){console.warn('Material "'+this.materialNames[A]+'" not found in mesh. Did you forget to call addMaterialLibrary(...)?"');break}i.setFloat32(d,L.dissolve,!0);break;case a.Layout.ILLUMINATION.key:var T=this.vertexMaterialIndices[r],R=this.materialsByIndex[T];if(!R){console.warn('Material "'+this.materialNames[T]+'" not found in mesh. Did you forget to call addMaterialLibrary(...)?"');break}i.setInt16(d,R.illumination,!0);break;case a.Layout.REFRACTION_INDEX.key:var k=this.vertexMaterialIndices[r],C=this.materialsByIndex[k];if(!C){console.warn('Material "'+this.materialNames[k]+'" not found in mesh. Did you forget to call addMaterialLibrary(...)?"');break}i.setFloat32(d,C.refractionIndex,!0);break;case a.Layout.SHARPNESS.key:var I=this.vertexMaterialIndices[r],O=this.materialsByIndex[I];if(!O){console.warn('Material "'+this.materialNames[I]+'" not found in mesh. Did you forget to call addMaterialLibrary(...)?"');break}i.setFloat32(d,O.sharpness,!0);break;case a.Layout.ANTI_ALIASING.key:var B=this.vertexMaterialIndices[r],P=this.materialsByIndex[B];if(!P){console.warn('Material "'+this.materialNames[B]+'" not found in mesh. Did you forget to call addMaterialLibrary(...)?"');break}i.setInt16(d,P.antiAliasing,!0)}}}catch(e){u=!0,c=e}finally{try{!s&&h.return&&h.return()}finally{if(u)throw c}}}return n}},{key:"makeIndexBufferData",value:function(){var e=new Uint16Array(this.indices);return e.numItems=this.indices.length,e}},{key:"addMaterialLibrary",value:function(e){for(var t in e.materials)if(t in this.materialIndices){var n=e.materials[t],i=this.materialIndices[n.name];this.materialsByIndex[i]=n}}}]),e}();t.default=s},function(e,t,n){"use strict";function i(e){return Array.isArray(e)?e:Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=t.Material=function e(t){r(this,e),this.name=t,this.ambient=[0,0,0],this.diffuse=[0,0,0],this.specular=[0,0,0],this.emissive=[0,0,0],this.transmissionFilter=[0,0,0],this.dissolve=0,this.specularExponent=0,this.transparency=0,this.illumination=0,this.refractionIndex=1,this.sharpness=0,this.mapDiffuse=null,this.mapAmbient=null,this.mapSpecular=null,this.mapSpecularExponent=null,this.mapDissolve=null,this.antiAliasing=!1,this.mapBump=null,this.mapDisplacement=null,this.mapDecal=null,this.mapEmissive=null,this.mapReflections=[]};t.MaterialLibrary=function(){function e(t){r(this,e),this.data=t,this.currentMaterial=null,this.materials={},this.parse()}return o(e,[{key:"parse_newmtl",value:function(e){var t=e[0];this.currentMaterial=new a(t),this.materials[t]=this.currentMaterial}},{key:"parseColor",value:function(e){if("spectral"!=e[0]){if("xyz"!=e[0]){if(3==e.length)return e.map(parseFloat);var t=parseFloat(e[0]);return[t,t,t]}console.warn("TODO: convert XYZ to RGB")}else console.error("The MTL parser does not support spectral curve files. You will need to convert the MTL colors to either RGB or CIEXYZ.")}},{key:"parse_Ka",value:function(e){this.currentMaterial.ambient=this.parseColor(e)}},{key:"parse_Kd",value:function(e){this.currentMaterial.diffuse=this.parseColor(e)}},{key:"parse_Ks",value:function(e){this.currentMaterial.specular=this.parseColor(e)}},{key:"parse_Ke",value:function(e){this.currentMaterial.emissive=this.parseColor(e)}},{key:"parse_Tf",value:function(e){this.currentMaterial.transmissionFilter=this.parseColor(e)}},{key:"parse_d",value:function(e){this.currentMaterial.dissolve=parseFloat(e.pop())}},{key:"parse_illum",value:function(e){this.currentMaterial.illumination=parseInt(e[0])}},{key:"parse_Ni",value:function(e){this.currentMaterial.refractionIndex=parseFloat(e[0])}},{key:"parse_Ns",value:function(e){this.currentMaterial.specularExponent=parseInt(e[0])}},{key:"parse_sharpness",value:function(e){this.currentMaterial.sharpness=parseInt(e[0])}},{key:"parse_cc",value:function(e,t){t.colorCorrection="on"==e[0]}},{key:"parse_blendu",value:function(e,t){t.horizontalBlending="on"==e[0]}},{key:"parse_blendv",value:function(e,t){t.verticalBlending="on"==e[0]}},{key:"parse_boost",value:function(e,t){t.boostMipMapSharpness=parseFloat(e[0])}},{key:"parse_mm",value:function(e,t){t.modifyTextureMap.brightness=parseFloat(e[0]),t.modifyTextureMap.contrast=parseFloat(e[1])}},{key:"parse_ost",value:function(e,t,n){for(;e.length<3;)e.push(n);t.u=parseFloat(e[0]),t.v=parseFloat(e[1]),t.w=parseFloat(e[2])}},{key:"parse_o",value:function(e,t){this.parse_ost(e,t.offset,0)}},{key:"parse_s",value:function(e,t){this.parse_ost(e,t.scale,1)}},{key:"parse_t",value:function(e,t){this.parse_ost(e,t.turbulence,0)}},{key:"parse_texres",value:function(e,t){t.textureResolution=parseFloat(e[0])}},{key:"parse_clamp",value:function(e,t){t.clamp="on"==e[0]}},{key:"parse_bm",value:function(e,t){t.bumpMultiplier=parseFloat(e[0])}},{key:"parse_imfchan",value:function(e,t){t.imfChan=e[0]}},{key:"parse_type",value:function(e,t){t.reflectionType=e[0]}},{key:"parseOptions",value:function(e){var t={colorCorrection:!1,horizontalBlending:!0,verticalBlending:!0,boostMipMapSharpness:0,modifyTextureMap:{brightness:0,contrast:1},offset:{u:0,v:0,w:0},scale:{u:1,v:1,w:1},turbulence:{u:0,v:0,w:0},clamp:!1,textureResolution:null,bumpMultiplier:1,imfChan:null},n=void 0,i=void 0,r={};for(e.reverse();e.length;){var o=e.pop();o.startsWith("-")?r[n=o.substr(1)]=[]:r[n].push(o)}for(n in r)if(r.hasOwnProperty(n)){i=r[n];var a=this["parse_"+n];a&&a.bind(this)(i,t)}return t}},{key:"parseMap",value:function(e){var t=void 0,n=void 0;if(e[0].startsWith("-"))t=e.pop(),n=e;else{var r=i(e);t=r[0],n=r.slice(1)}return n=this.parseOptions(n),n.filename=t,n}},{key:"parse_map_Ka",value:function(e){this.currentMaterial.mapAmbient=this.parseMap(e)}},{key:"parse_map_Kd",value:function(e){this.currentMaterial.mapDiffuse=this.parseMap(e)}},{key:"parse_map_Ks",value:function(e){this.currentMaterial.mapSpecular=this.parseMap(e)}},{key:"parse_map_Ke",value:function(e){this.currentMaterial.mapEmissive=this.parseMap(e)}},{key:"parse_map_Ns",value:function(e){this.currentMaterial.mapSpecularExponent=this.parseMap(e)}},{key:"parse_map_d",value:function(e){this.currentMaterial.mapDissolve=this.parseMap(e)}},{key:"parse_map_aat",value:function(e){this.currentMaterial.antiAliasing="on"==e[0]}},{key:"parse_map_bump",value:function(e){this.currentMaterial.mapBump=this.parseMap(e)}},{key:"parse_bump",value:function(e){this.parse_map_bump(e)}},{key:"parse_disp",value:function(e){this.currentMaterial.mapDisplacement=this.parseMap(e)}},{key:"parse_decal",value:function(e){this.currentMaterial.mapDecal=this.parseMap(e)}},{key:"parse_refl",value:function(e){this.currentMaterial.mapReflections.push(this.parseMap(e))}},{key:"parse",value:function(){var e=this.data.split(/\r?\n/),t=!0,n=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var s=o.value;if((s=s.trim())&&!s.startsWith("#")){var u=s.split(/\s/),c=void 0,l=i(u);c=l[0],u=l.slice(1);var h=this["parse_"+c];h?h.bind(this)(u):console.warn("Don't know how to parse the directive: \""+c+'"')}}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}delete this.data,this.currentMaterial=null}}]),e}()},function(e,t,n){e.exports=n(4)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteMeshBuffers=t.initMeshBuffers=t.downloadMeshes=t.downloadModels=t.Layout=t.MaterialLibrary=t.Material=t.Mesh=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(n(1)),r=n(2),o=n(0),a=n(5);t.Mesh=i.default,t.Material=r.Material,t.MaterialLibrary=r.MaterialLibrary,t.Layout=o.Layout,t.downloadModels=a.downloadModels,t.downloadMeshes=a.downloadMeshes,t.initMeshBuffers=a.initMeshBuffers,t.deleteMeshBuffers=a.deleteMeshBuffers},function(e,t,n){"use strict";function i(e,t){var n=["mapDiffuse","mapAmbient","mapSpecular","mapDissolve","mapBump","mapDisplacement","mapDecal","mapEmissive"];t.endsWith("/")||(t+="/");var i=[];for(var r in e.materials)if(e.materials.hasOwnProperty(r)){r=e.materials[r];var o=function(e){var n=r[e];if(!n)return"continue";var o=t+n.filename;i.push(fetch(o).then(function(e){if(!e.ok)throw new Error;return e.blob()}).then(function(e){var t=new Image;t.src=URL.createObjectURL(e),n.texture=t}).catch(function(){console.error("Unable to download texture: "+o)}))},a=!0,s=!1,u=void 0;try{for(var c,l=n[Symbol.iterator]();!(a=(c=l.next()).done);a=!0)o(c.value)}catch(e){s=!0,u=e}finally{try{!a&&l.return&&l.return()}finally{if(s)throw u}}}return Promise.all(i)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.downloadModels=function(e){var t=[],n=!0,s=!1,u=void 0;try{for(var c,l=e[Symbol.iterator]();!(n=(c=l.next()).done);n=!0)!function(e){var n=[];if(!e.obj)throw new Error('"obj" attribute of model object not set. The .obj file is required to be set in order to use downloadModels()');var r=e.name;if(!r){var s=e.obj.split("/");r=s[s.length-1].replace(".obj","")}if(n.push(Promise.resolve(r)),n.push(fetch(e.obj).then(function(e){return e.text()}).then(function(e){return new o.default(e)})),e.mtl){var u=e.mtl;"boolean"==typeof u&&(u=e.obj.replace(/\.obj$/,".mtl")),n.push(fetch(u).then(function(e){return e.text()}).then(function(t){var n=new a.MaterialLibrary(t);if(!1!==e.downloadMtlTextures){var r=e.mtlTextureRoot;return r||(r=u.substr(0,u.lastIndexOf("/"))),Promise.all([Promise.resolve(n),i(n,r)])}return Promise.all(Promise.resolve(n))}).then(function(e){return e[0]}))}t.push(Promise.all(n))}(c.value)}catch(e){s=!0,u=e}finally{try{!n&&l.return&&l.return()}finally{if(s)throw u}}return Promise.all(t).then(function(e){var t={},n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var u=a.value,c=r(u,3),l=c[0],h=c[1],f=c[2];h.name=l,f&&h.addMaterialLibrary(f),t[l]=h}}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return t})},t.downloadMeshes=function(e,t,n){void 0===n&&(n={});var i=[];for(var a in e)!function(t){if(!e.hasOwnProperty(t))return"continue";var n=e[t];i.push(fetch(n).then(function(e){return e.text()}).then(function(e){return[t,new o.default(e)]}))}(a);Promise.all(i).then(function(e){var i=!0,o=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value,l=r(c,2),h=l[0],f=l[1];n[h]=f}}catch(e){o=!0,a=e}finally{try{!i&&u.return&&u.return()}finally{if(o)throw a}}return t(n)})},t.initMeshBuffers=function(e,t){t.normalBuffer=s(e,e.ARRAY_BUFFER,t.vertexNormals,3),t.textureBuffer=s(e,e.ARRAY_BUFFER,t.textures,2),t.vertexBuffer=s(e,e.ARRAY_BUFFER,t.vertices,3),t.indexBuffer=s(e,e.ELEMENT_ARRAY_BUFFER,t.indices,1)},t.deleteMeshBuffers=function(e,t){e.deleteBuffer(t.normalBuffer),e.deleteBuffer(t.textureBuffer),e.deleteBuffer(t.vertexBuffer),e.deleteBuffer(t.indexBuffer)};var o=function(e){return e&&e.__esModule?e:{default:e}}(n(1)),a=n(2),s=(n(0),function(e,t,n,i){var r=e.createBuffer(),o=t===e.ARRAY_BUFFER?Float32Array:Uint16Array;return e.bindBuffer(t,r),e.bufferData(t,new o(n),e.STATIC_DRAW),r.itemSize=i,r.numItems=n.length/i,r})}])})},function(e,t,n){"use strict";var i=n(55),r=n.n(i);n(12);class o{constructor(){this.loader=new r.a}load(e,t){return new Promise(n=>{this.loader.load(e,t,(e,t)=>{n(void 0)})})}}t.a=o},function(e,t,n){function i(){this.vertices=[],this.normals=[],this.textureCoords=[],this.faces=[],this.facesMaterialsIndex=[{materialName:null,materialStartIndex:0}],this.materials=[]}var r=n(25),o=n(68),a=n(70);i.prototype.load=function(e,t,n){var i=this;"function"==typeof t&&(n=t,t=""),a(e,function(e,r,s){e&&n(e),i.createReadStream(s).pipe(o()).on("data",function(e){i.parseObj(e)}).on("end",function(){"string"==typeof t&&""!==t?a(t,function(e,t,r){e&&n(e);var a={};i.createReadStream(r).pipe(o()).on("data",function(e){a=i.parseMtl(e,a)}).on("end",function(){a.name&&i.materials.push(a),n(null,{vertices:i.vertices,normals:i.normals,textureCoords:i.textureCoords,faces:i.faces,facesMaterialsIndex:i.facesMaterialsIndex,materials:i.materials})}).on("err",function(e){n(e)})}):n(null,{vertices:i.vertices,normals:i.normals,textureCoords:i.textureCoords,faces:i.faces})}).on("err",function(e){n(e)})})},i.prototype.createReadStream=function(e){var t=new r.Readable;return t._read=function(){},t.push(e),t.push(null),t},i.prototype.parseObj=function(e){var t=e.indexOf("#");-1!=t&&(e=e.substring(0,t));var n=(e=e.trim()).split(/\s+/);if("v"===n[0]){var i=[Number(n[1]),Number(n[2]),Number(n[3]),n[4]?1:Number(n[4])];this.vertices.push(i)}else if("vt"===n[0]){var r=[Number(n[1]),Number(n[2]),n[3]?1:Number(n[3])];this.textureCoords.push(r)}else if("vn"===n[0]){var o=[Number(n[1]),Number(n[2]),Number(n[3])];this.normals.push(o)}else if("f"===n[0]){for(var a={indices:[],texture:[],normal:[]},s=1;s<n.length;++s){var u=n[s].indexOf("//"),c=n[s].split(/\W+/);u>0?(a.indices.push(c[0]),a.normal.push(c[1])):1===c.length?a.indices.push(c[0]):2===c.length?(a.indices.push(c[0]),a.texture.push(c[1])):3===c.length&&(a.indices.push(c[0]),a.texture.push(c[1]),a.normal.push(c[2]))}this.faces.push(a)}else if("usemtl"===n[0])if(0===this.faces.length)this.facesMaterialsIndex[0].materialName=n[1];else{var l=n[1],h=this.faces.length;this.facesMaterialsIndex.push({materialName:l,materialStartIndex:h})}},i.prototype.parseMtl=function(e,t){var n=e.indexOf("#");-1!=n&&(e=e.substring(0,n));var i=(e=e.trim()).split(/\s+/);if("newmtl"===i[0])t.name&&(this.materials.push(t),t={}),t.name=i[1];else if("Ka"===i[0]){t.ambient=[];for(r=0;r<3;++r)t.ambient.push(i[r+1])}else if("Kd"===i[0]){t.diffuse=[];for(r=0;r<3;++r)t.diffuse.push(i[r+1])}else if("Ks"===i[0]){t.specular=[];for(var r=0;r<3;++r)t.specular.push(i[r+1])}else"Ns"===i[0]?t.specularExponent=i[1]:"d"===i[0]||"Tr"===i[0]?t.transparent=i[1]:"illum"===i[0]?t.illumMode=i[1]:"map_Ka"===i[0]?t.ambientMap=i[1]:"map_Kd"===i[0]?t.diffuseMap=i[1]:"map_Ks"===i[0]?t.specularMap=i[1]:"map_d"===i[0]?t.alphaMat=i[1]:"map_bump"===i[0]||"bump"===i[0]?t.bumpMap=i[1]:"disp"===i[0]&&(t.displacementMap=i[1]);return t},e.exports=i},function(e,t,n){"use strict";function i(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function r(e){return a[e>>18&63]+a[e>>12&63]+a[e>>6&63]+a[63&e]}function o(e,t,n){for(var i,o=[],a=t;a<n;a+=3)i=(e[a]<<16)+(e[a+1]<<8)+e[a+2],o.push(r(i));return o.join("")}t.byteLength=function(e){return 3*e.length/4-i(e)},t.toByteArray=function(e){var t,n,r,o,a,c=e.length;o=i(e),a=new u(3*c/4-o),n=o>0?c-4:c;var l=0;for(t=0;t<n;t+=4)r=s[e.charCodeAt(t)]<<18|s[e.charCodeAt(t+1)]<<12|s[e.charCodeAt(t+2)]<<6|s[e.charCodeAt(t+3)],a[l++]=r>>16&255,a[l++]=r>>8&255,a[l++]=255&r;return 2===o?(r=s[e.charCodeAt(t)]<<2|s[e.charCodeAt(t+1)]>>4,a[l++]=255&r):1===o&&(r=s[e.charCodeAt(t)]<<10|s[e.charCodeAt(t+1)]<<4|s[e.charCodeAt(t+2)]>>2,a[l++]=r>>8&255,a[l++]=255&r),a},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,r="",s=[],u=0,c=n-i;u<c;u+=16383)s.push(o(e,u,u+16383>c?c:u+16383));return 1===i?(t=e[n-1],r+=a[t>>2],r+=a[t<<4&63],r+="=="):2===i&&(t=(e[n-2]<<8)+e[n-1],r+=a[t>>10],r+=a[t>>4&63],r+=a[t<<2&63],r+="="),s.push(r),s.join("")};for(var a=[],s=[],u="undefined"!=typeof Uint8Array?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,h=c.length;l<h;++l)a[l]=c[l],s[c.charCodeAt(l)]=l;s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,i,r){var o,a,s=8*r-i-1,u=(1<<s)-1,c=u>>1,l=-7,h=n?r-1:0,f=n?-1:1,d=e[t+h];for(h+=f,o=d&(1<<-l)-1,d>>=-l,l+=s;l>0;o=256*o+e[t+h],h+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=i;l>0;a=256*a+e[t+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,i),o-=c}return(d?-1:1)*a*Math.pow(2,o-i)},t.write=function(e,t,n,i,r,o){var a,s,u,c=8*o-r-1,l=(1<<c)-1,h=l>>1,f=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:o-1,p=i?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(a++,u/=2),a+h>=l?(s=0,a=l):a+h>=1?(s=(t*u-1)*Math.pow(2,r),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,r),a=0));r>=8;e[n+d]=255&s,d+=p,s/=256,r-=8);for(a=a<<r|s,c+=r;c>0;e[n+d]=255&a,d+=p,a/=256,c-=8);e[n+d-p]|=128*m}},function(e,t){},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t,n){e.copy(t,n)}var o=n(15).Buffer;e.exports=function(){function e(){i(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},e.prototype.concat=function(e){if(0===this.length)return o.alloc(0);if(1===this.length)return this.head.data;for(var t=o.allocUnsafe(e>>>0),n=this.head,i=0;n;)r(n.data,t,i),i+=n.data.length,n=n.next;return t},e}()},function(e,t,n){function i(e,t){this._id=e,this._clearFn=t}var r=Function.prototype.apply;t.setTimeout=function(){return new i(r.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new i(r.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(61),t.setImmediate=setImmediate,t.clearImmediate=clearImmediate},function(e,t,n){(function(e,t){!function(e,n){"use strict";function i(e){delete u[e]}function r(e){var t=e.callback,i=e.args;switch(i.length){case 0:t();break;case 1:t(i[0]);break;case 2:t(i[0],i[1]);break;case 3:t(i[0],i[1],i[2]);break;default:t.apply(n,i)}}function o(e){if(c)setTimeout(o,0,e);else{var t=u[e];if(t){c=!0;try{r(t)}finally{i(e),c=!1}}}}if(!e.setImmediate){var a,s=1,u={},c=!1,l=e.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(e);h=h&&h.setTimeout?h:e,"[object process]"==={}.toString.call(e.process)?a=function(e){t.nextTick(function(){o(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&o(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),a=function(n){e.postMessage(t+n,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){o(e.data)},a=function(t){e.port2.postMessage(t)}}():l&&"onreadystatechange"in l.createElement("script")?function(){var e=l.documentElement;a=function(t){var n=l.createElement("script");n.onreadystatechange=function(){o(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():a=function(e){setTimeout(o,0,e)},h.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return u[s]=i,a(s),s++},h.clearImmediate=i}}("undefined"==typeof self?void 0===e?this:e:self)}).call(t,n(3),n(7))},function(e,t,n){(function(t){function n(e){try{if(!t.localStorage)return!1}catch(e){return!1}var n=t.localStorage[e];return null!=n&&"true"===String(n).toLowerCase()}e.exports=function(e,t){if(n("noDeprecation"))return e;var i=!1;return function(){if(!i){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),i=!0}return e.apply(this,arguments)}}}).call(t,n(3))},function(e,t,n){"use strict";function i(e){if(!(this instanceof i))return new i(e);r.call(this,e)}e.exports=i;var r=n(30),o=n(8);o.inherits=n(6),o.inherits(i,r),i.prototype._transform=function(e,t,n){n(null,e)}},function(e,t,n){e.exports=n(17)},function(e,t,n){e.exports=n(4)},function(e,t,n){e.exports=n(14).Transform},function(e,t,n){e.exports=n(14).PassThrough},function(e,t,n){var i=n(69),r=n(18).StringDecoder;e.exports=function(e,t,n){function o(e,n){if(t){try{n=t(n)}catch(t){return e.emit("error",t)}void 0!==n&&e.queue(n)}else e.queue(n)}function a(t,n){var i=((null!=u?u:"")+n).split(e);u=i.pop(),c&&u.length>c&&t.emit("error",new Error("maximum buffer reached"));for(var r=0;r<i.length;r++)o(t,i[r])}var s=new r,u="",c=n&&n.maxLength;return"function"==typeof e&&(t=e,e=null),e||(e=/\r?\n/),i(function(e){a(this,s.write(e))},function(){s.end&&a(this,s.end()),null!=u&&o(this,u),this.queue(null)})}},function(e,t,n){(function(i){function r(e,t,n){function r(){for(;c.length&&!h.paused;){var e=c.shift();if(null===e)return h.emit("end");h.emit("data",e)}}function a(){h.writable=!1,t.call(h),!h.readable&&h.autoDestroy&&h.destroy()}e=e||function(e){this.queue(e)},t=t||function(){this.queue(null)};var s=!1,u=!1,c=[],l=!1,h=new o;return h.readable=h.writable=!0,h.paused=!1,h.autoDestroy=!(n&&!1===n.autoDestroy),h.write=function(t){return e.call(this,t),!h.paused},h.queue=h.push=function(e){return l?h:(null===e&&(l=!0),c.push(e),r(),h)},h.on("end",function(){h.readable=!1,!h.writable&&h.autoDestroy&&i.nextTick(function(){h.destroy()})}),h.end=function(e){if(!s)return s=!0,arguments.length&&h.write(e),a(),h},h.destroy=function(){if(!u)return u=!0,s=!0,c.length=0,h.writable=h.readable=!1,h.emit("close"),h},h.pause=function(){if(!h.paused)return h.paused=!0,h},h.resume=function(){return h.paused&&(h.paused=!1,h.emit("resume")),r(),h.paused||h.emit("drain"),h},h}var o=n(25);t=e.exports=r,r.through=r}).call(t,n(7))},function(e,t,n){"use strict";function i(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function r(e,t,n){var i=e;return c(t)?(n=t,"string"==typeof e&&(i={uri:e})):i=h(t,{uri:e}),i.callback=n,i}function o(e,t,n){return t=r(e,t,n),a(t)}function a(e){function t(){var e=void 0;if(e=c.response?c.response:c.responseText||s(c),_)try{e=JSON.parse(e)}catch(e){}return e}function n(e){return clearTimeout(d),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,u(e,y)}function r(){if(!f){var n;clearTimeout(d),n=e.useXDR&&void 0===c.status?200:1223===c.status?204:c.status;var i=y,r=null;return 0!==n?(i={body:t(),statusCode:n,method:m,headers:{},url:p,rawRequest:c},c.getAllResponseHeaders&&(i.headers=l(c.getAllResponseHeaders()))):r=new Error("Internal XMLHttpRequest Error"),u(r,i,i.body)}}if(void 0===e.callback)throw new Error("callback argument missing");var a=!1,u=function(t,n,i){a||(a=!0,e.callback(t,n,i))},c=e.xhr||null;c||(c=e.cors||e.useXDR?new o.XDomainRequest:new o.XMLHttpRequest);var h,f,d,p=c.url=e.uri||e.url,m=c.method=e.method||"GET",v=e.body||e.data,g=c.headers=e.headers||{},b=!!e.sync,_=!1,y={body:void 0,headers:{},statusCode:0,method:m,url:p,rawRequest:c};if("json"in e&&!1!==e.json&&(_=!0,g.accept||g.Accept||(g.Accept="application/json"),"GET"!==m&&"HEAD"!==m&&(g["content-type"]||g["Content-Type"]||(g["Content-Type"]="application/json"),v=JSON.stringify(!0===e.json?v:e.json))),c.onreadystatechange=function(){4===c.readyState&&setTimeout(r,0)},c.onload=r,c.onerror=n,c.onprogress=function(){},c.onabort=function(){f=!0},c.ontimeout=n,c.open(m,p,!b,e.username,e.password),b||(c.withCredentials=!!e.withCredentials),!b&&e.timeout>0&&(d=setTimeout(function(){if(!f){f=!0,c.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",n(e)}},e.timeout)),c.setRequestHeader)for(h in g)g.hasOwnProperty(h)&&c.setRequestHeader(h,g[h]);else if(e.headers&&!i(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(c.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(c),c.send(v||null),c}function s(e){if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;return""!==e.responseType||t?null:e.responseXML}var u=n(71),c=n(31),l=n(72),h=n(75);e.exports=o,o.XMLHttpRequest=u.XMLHttpRequest||function(){},o.XDomainRequest="withCredentials"in new o.XMLHttpRequest?o.XMLHttpRequest:u.XDomainRequest,function(e,t){for(var n=0;n<e.length;n++)t(e[n])}(["get","put","post","patch","head","delete"],function(e){o["delete"===e?"del":e]=function(t,n,i){return n=r(t,n,i),n.method=e.toUpperCase(),a(n)}})},function(e,t,n){(function(t){var n;n="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},e.exports=n}).call(t,n(3))},function(e,t,n){var i=n(73),r=n(74),o=function(e){return"[object Array]"===Object.prototype.toString.call(e)};e.exports=function(e){if(!e)return{};var t={};return r(i(e).split("\n"),function(e){var n=e.indexOf(":"),r=i(e.slice(0,n)).toLowerCase(),a=i(e.slice(n+1));void 0===t[r]?t[r]=a:o(t[r])?t[r].push(a):t[r]=[t[r],a]}),t}},function(e,t){(t=e.exports=function(e){return e.replace(/^\s*|\s*$/g,"")}).left=function(e){return e.replace(/^\s*/,"")},t.right=function(e){return e.replace(/\s*$/,"")}},function(e,t,n){function i(e,t,n){for(var i=0,r=e.length;i<r;i++)u.call(e,i)&&t.call(n,e[i],i,e)}function r(e,t,n){for(var i=0,r=e.length;i<r;i++)t.call(n,e.charAt(i),i,e)}function o(e,t,n){for(var i in e)u.call(e,i)&&t.call(n,e[i],i,e)}var a=n(31);e.exports=function(e,t,n){if(!a(t))throw new TypeError("iterator must be a function");arguments.length<3&&(n=this),"[object Array]"===s.call(e)?i(e,t,n):"string"==typeof e?r(e,t,n):o(e,t,n)};var s=Object.prototype.toString,u=Object.prototype.hasOwnProperty},function(e,t){e.exports=function(){for(var e={},t=0;t<arguments.length;t++){var i=arguments[t];for(var r in i)n.call(i,r)&&(e[r]=i[r])}return e};var n=Object.prototype.hasOwnProperty},function(e,t,n){"use strict";class i{constructor(){}loadImages(e){let t=[];return Object.entries(e).forEach(([e,n])=>{const i=new Promise(t=>{const i=new Image;i.onload=(()=>{const n={[e]:{width:i.width,height:i.height,data:i}};t(n)}),i.src=n});t.push(i)}),Promise.all(t)}}t.a=i}])});